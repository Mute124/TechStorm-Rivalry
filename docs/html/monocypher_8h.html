<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TechStorm-Rivalry: techstorm/lib/rres-1.2.0/rres-1.2.0/src/external/monocypher.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TechStorm-Rivalry
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('monocypher_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">monocypher.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
</div>
<p><a href="monocypher_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__argon2__config.html">crypto_argon2_config</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__argon2__inputs.html">crypto_argon2_inputs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__argon2__extras.html">crypto_argon2_extras</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__poly1305__ctx.html">crypto_poly1305_ctx</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afaa7bd239e123ac2924f7df35cbd045a" id="r_afaa7bd239e123ac2924f7df35cbd045a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#afaa7bd239e123ac2924f7df35cbd045a">CRYPTO_ARGON2_D</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:afaa7bd239e123ac2924f7df35cbd045a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b8a0eed4244d4002f72afc61a6152c" id="r_ad9b8a0eed4244d4002f72afc61a6152c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#ad9b8a0eed4244d4002f72afc61a6152c">CRYPTO_ARGON2_I</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ad9b8a0eed4244d4002f72afc61a6152c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad22d01244500852db18539f17716eb0f" id="r_ad22d01244500852db18539f17716eb0f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#ad22d01244500852db18539f17716eb0f">CRYPTO_ARGON2_ID</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ad22d01244500852db18539f17716eb0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2c6a2ddf6e849ea17747b25d1751271d" id="r_a2c6a2ddf6e849ea17747b25d1751271d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a2c6a2ddf6e849ea17747b25d1751271d">crypto_verify16</a> (const uint8_t a[16], const uint8_t b[16])</td></tr>
<tr class="separator:a2c6a2ddf6e849ea17747b25d1751271d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311150eae3c7e72096237d70f3f3083b" id="r_a311150eae3c7e72096237d70f3f3083b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a311150eae3c7e72096237d70f3f3083b">crypto_verify32</a> (const uint8_t a[32], const uint8_t b[32])</td></tr>
<tr class="separator:a311150eae3c7e72096237d70f3f3083b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c52e2447a43a7e7546f466f55161021" id="r_a8c52e2447a43a7e7546f466f55161021"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a8c52e2447a43a7e7546f466f55161021">crypto_verify64</a> (const uint8_t a[64], const uint8_t b[64])</td></tr>
<tr class="separator:a8c52e2447a43a7e7546f466f55161021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84904a8f94da26863cb33a9375c0a63a" id="r_a84904a8f94da26863cb33a9375c0a63a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a84904a8f94da26863cb33a9375c0a63a">crypto_wipe</a> (void *secret, size_t size)</td></tr>
<tr class="separator:a84904a8f94da26863cb33a9375c0a63a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad43cc3eabc0ca0d57e9a2c7e8cb3a531" id="r_ad43cc3eabc0ca0d57e9a2c7e8cb3a531"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#ad43cc3eabc0ca0d57e9a2c7e8cb3a531">crypto_aead_lock</a> (uint8_t *cipher_text, uint8_t mac[16], const uint8_t key[32], const uint8_t nonce[24], const uint8_t *ad, size_t ad_size, const uint8_t *plain_text, size_t text_size)</td></tr>
<tr class="separator:ad43cc3eabc0ca0d57e9a2c7e8cb3a531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecb4ce9a3f4def034e7479260a37d95c" id="r_aecb4ce9a3f4def034e7479260a37d95c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#aecb4ce9a3f4def034e7479260a37d95c">crypto_aead_unlock</a> (uint8_t *plain_text, const uint8_t mac[16], const uint8_t key[32], const uint8_t nonce[24], const uint8_t *ad, size_t ad_size, const uint8_t *cipher_text, size_t text_size)</td></tr>
<tr class="separator:aecb4ce9a3f4def034e7479260a37d95c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d02172c8b002b202948420c81ad833e" id="r_a7d02172c8b002b202948420c81ad833e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a7d02172c8b002b202948420c81ad833e">crypto_aead_init_x</a> (<a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *ctx, const uint8_t key[32], const uint8_t nonce[24])</td></tr>
<tr class="separator:a7d02172c8b002b202948420c81ad833e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a86991bc2860a264f3e0f2edabc1cd1" id="r_a8a86991bc2860a264f3e0f2edabc1cd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a8a86991bc2860a264f3e0f2edabc1cd1">crypto_aead_init_djb</a> (<a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *ctx, const uint8_t key[32], const uint8_t nonce[8])</td></tr>
<tr class="separator:a8a86991bc2860a264f3e0f2edabc1cd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71737acb039bbd757d29566b456301bb" id="r_a71737acb039bbd757d29566b456301bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a71737acb039bbd757d29566b456301bb">crypto_aead_init_ietf</a> (<a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *ctx, const uint8_t key[32], const uint8_t nonce[12])</td></tr>
<tr class="separator:a71737acb039bbd757d29566b456301bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f68322e3e6936bb9e5cc0dd61bc7056" id="r_a4f68322e3e6936bb9e5cc0dd61bc7056"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a4f68322e3e6936bb9e5cc0dd61bc7056">crypto_aead_write</a> (<a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *ctx, uint8_t *cipher_text, uint8_t mac[16], const uint8_t *ad, size_t ad_size, const uint8_t *plain_text, size_t text_size)</td></tr>
<tr class="separator:a4f68322e3e6936bb9e5cc0dd61bc7056"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a962568f81b3dead6deb7a7df9d446954" id="r_a962568f81b3dead6deb7a7df9d446954"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a962568f81b3dead6deb7a7df9d446954">crypto_aead_read</a> (<a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *ctx, uint8_t *plain_text, const uint8_t mac[16], const uint8_t *ad, size_t ad_size, const uint8_t *cipher_text, size_t text_size)</td></tr>
<tr class="separator:a962568f81b3dead6deb7a7df9d446954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16aa7d4b3ac7d423a95e8385e605ed1b" id="r_a16aa7d4b3ac7d423a95e8385e605ed1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a16aa7d4b3ac7d423a95e8385e605ed1b">crypto_blake2b</a> (uint8_t *hash, size_t hash_size, const uint8_t *message, size_t message_size)</td></tr>
<tr class="separator:a16aa7d4b3ac7d423a95e8385e605ed1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15866e182bfaf0419bbda3a5c94b6f45" id="r_a15866e182bfaf0419bbda3a5c94b6f45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a15866e182bfaf0419bbda3a5c94b6f45">crypto_blake2b_keyed</a> (uint8_t *hash, size_t hash_size, const uint8_t *key, size_t key_size, const uint8_t *message, size_t message_size)</td></tr>
<tr class="separator:a15866e182bfaf0419bbda3a5c94b6f45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ffa93aca7473a69cc440680c4951026" id="r_a7ffa93aca7473a69cc440680c4951026"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a7ffa93aca7473a69cc440680c4951026">crypto_blake2b_init</a> (<a class="el" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> *ctx, size_t hash_size)</td></tr>
<tr class="separator:a7ffa93aca7473a69cc440680c4951026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26a700af95a409458781b0e24090c27a" id="r_a26a700af95a409458781b0e24090c27a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a26a700af95a409458781b0e24090c27a">crypto_blake2b_keyed_init</a> (<a class="el" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> *ctx, size_t hash_size, const uint8_t *key, size_t key_size)</td></tr>
<tr class="separator:a26a700af95a409458781b0e24090c27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95aa6264859b5fff2623a731876aa15e" id="r_a95aa6264859b5fff2623a731876aa15e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a95aa6264859b5fff2623a731876aa15e">crypto_blake2b_update</a> (<a class="el" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> *ctx, const uint8_t *message, size_t message_size)</td></tr>
<tr class="separator:a95aa6264859b5fff2623a731876aa15e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa719a90928706c86e00d08781924c050" id="r_aa719a90928706c86e00d08781924c050"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#aa719a90928706c86e00d08781924c050">crypto_blake2b_final</a> (<a class="el" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> *ctx, uint8_t *hash)</td></tr>
<tr class="separator:aa719a90928706c86e00d08781924c050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84587b689d53a4382b0f94ffb67bd2cb" id="r_a84587b689d53a4382b0f94ffb67bd2cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a84587b689d53a4382b0f94ffb67bd2cb">crypto_argon2</a> (uint8_t *hash, uint32_t hash_size, void *work_area, <a class="el" href="structcrypto__argon2__config.html">crypto_argon2_config</a> config, <a class="el" href="structcrypto__argon2__inputs.html">crypto_argon2_inputs</a> inputs, <a class="el" href="structcrypto__argon2__extras.html">crypto_argon2_extras</a> extras)</td></tr>
<tr class="separator:a84587b689d53a4382b0f94ffb67bd2cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f758c23bd513d3961a083f545222c1d" id="r_a8f758c23bd513d3961a083f545222c1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a8f758c23bd513d3961a083f545222c1d">crypto_x25519_public_key</a> (uint8_t public_key[32], const uint8_t secret_key[32])</td></tr>
<tr class="separator:a8f758c23bd513d3961a083f545222c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba01f73b08a9c4ca852193bc107356ab" id="r_aba01f73b08a9c4ca852193bc107356ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#aba01f73b08a9c4ca852193bc107356ab">crypto_x25519</a> (uint8_t raw_shared_secret[32], const uint8_t your_secret_key[32], const uint8_t their_public_key[32])</td></tr>
<tr class="separator:aba01f73b08a9c4ca852193bc107356ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c3366e8cdb2ef53bb1a49ea7b56770c" id="r_a7c3366e8cdb2ef53bb1a49ea7b56770c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a7c3366e8cdb2ef53bb1a49ea7b56770c">crypto_x25519_to_eddsa</a> (uint8_t eddsa[32], const uint8_t x25519[32])</td></tr>
<tr class="separator:a7c3366e8cdb2ef53bb1a49ea7b56770c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea80388b64675e8de9e0b0ceb757d956" id="r_aea80388b64675e8de9e0b0ceb757d956"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#aea80388b64675e8de9e0b0ceb757d956">crypto_x25519_inverse</a> (uint8_t blind_salt[32], const uint8_t private_key[32], const uint8_t curve_point[32])</td></tr>
<tr class="separator:aea80388b64675e8de9e0b0ceb757d956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ccb80a6e7439b981dcb3021648a83a" id="r_a55ccb80a6e7439b981dcb3021648a83a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a55ccb80a6e7439b981dcb3021648a83a">crypto_x25519_dirty_small</a> (uint8_t pk[32], const uint8_t sk[32])</td></tr>
<tr class="separator:a55ccb80a6e7439b981dcb3021648a83a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf6ea02e2f70cd4bff6aa318e2466053" id="r_acf6ea02e2f70cd4bff6aa318e2466053"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#acf6ea02e2f70cd4bff6aa318e2466053">crypto_x25519_dirty_fast</a> (uint8_t pk[32], const uint8_t sk[32])</td></tr>
<tr class="separator:acf6ea02e2f70cd4bff6aa318e2466053"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17524bc5d32fc326a4e52a2daa2e7e19" id="r_a17524bc5d32fc326a4e52a2daa2e7e19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a17524bc5d32fc326a4e52a2daa2e7e19">crypto_eddsa_key_pair</a> (uint8_t secret_key[64], uint8_t public_key[32], uint8_t seed[32])</td></tr>
<tr class="separator:a17524bc5d32fc326a4e52a2daa2e7e19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa3f01f65bc3d90f4bb9d81b51287e5" id="r_a8aa3f01f65bc3d90f4bb9d81b51287e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a8aa3f01f65bc3d90f4bb9d81b51287e5">crypto_eddsa_sign</a> (uint8_t signature[64], const uint8_t secret_key[64], const uint8_t *message, size_t message_size)</td></tr>
<tr class="separator:a8aa3f01f65bc3d90f4bb9d81b51287e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e202116983caacc8a0c8488c715760b" id="r_a7e202116983caacc8a0c8488c715760b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a7e202116983caacc8a0c8488c715760b">crypto_eddsa_check</a> (const uint8_t signature[64], const uint8_t public_key[32], const uint8_t *message, size_t message_size)</td></tr>
<tr class="separator:a7e202116983caacc8a0c8488c715760b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86969e0548a6ecfdf28ff0efcb2413a2" id="r_a86969e0548a6ecfdf28ff0efcb2413a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a86969e0548a6ecfdf28ff0efcb2413a2">crypto_eddsa_to_x25519</a> (uint8_t x25519[32], const uint8_t eddsa[32])</td></tr>
<tr class="memdesc:a86969e0548a6ecfdf28ff0efcb2413a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">EdDSA &lt;--&gt; X25519 ///.  <br /></td></tr>
<tr class="separator:a86969e0548a6ecfdf28ff0efcb2413a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabc1047df275e017ae5dce43a806b2dc" id="r_aabc1047df275e017ae5dce43a806b2dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#aabc1047df275e017ae5dce43a806b2dc">crypto_eddsa_trim_scalar</a> (uint8_t out[32], const uint8_t in[32])</td></tr>
<tr class="separator:aabc1047df275e017ae5dce43a806b2dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e7a43edd08e9b4320d1db7579286c97" id="r_a0e7a43edd08e9b4320d1db7579286c97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a0e7a43edd08e9b4320d1db7579286c97">crypto_eddsa_reduce</a> (uint8_t reduced[32], const uint8_t expanded[64])</td></tr>
<tr class="separator:a0e7a43edd08e9b4320d1db7579286c97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab9136f4202134dce3d689ff92aae36d" id="r_aab9136f4202134dce3d689ff92aae36d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#aab9136f4202134dce3d689ff92aae36d">crypto_eddsa_mul_add</a> (uint8_t r[32], const uint8_t a[32], const uint8_t b[32], const uint8_t c[32])</td></tr>
<tr class="separator:aab9136f4202134dce3d689ff92aae36d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a224ab287277af8262e7f6d069ec1d89b" id="r_a224ab287277af8262e7f6d069ec1d89b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a224ab287277af8262e7f6d069ec1d89b">crypto_eddsa_scalarbase</a> (uint8_t point[32], const uint8_t scalar[32])</td></tr>
<tr class="separator:a224ab287277af8262e7f6d069ec1d89b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aa5f875e129881fb044f0c5c1f92bbe" id="r_a3aa5f875e129881fb044f0c5c1f92bbe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a3aa5f875e129881fb044f0c5c1f92bbe">crypto_eddsa_check_equation</a> (const uint8_t signature[64], const uint8_t public_key[32], const uint8_t h_ram[32])</td></tr>
<tr class="separator:a3aa5f875e129881fb044f0c5c1f92bbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af524b38e04a09fc0ecc86bebb5011bd9" id="r_af524b38e04a09fc0ecc86bebb5011bd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#af524b38e04a09fc0ecc86bebb5011bd9">crypto_chacha20_h</a> (uint8_t out[32], const uint8_t key[32], const uint8_t in[16])</td></tr>
<tr class="separator:af524b38e04a09fc0ecc86bebb5011bd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7976df9d72c90b050613197806acd3a" id="r_aa7976df9d72c90b050613197806acd3a"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#aa7976df9d72c90b050613197806acd3a">crypto_chacha20_djb</a> (uint8_t *cipher_text, const uint8_t *plain_text, size_t text_size, const uint8_t key[32], const uint8_t nonce[8], uint64_t ctr)</td></tr>
<tr class="separator:aa7976df9d72c90b050613197806acd3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e0bc782678f9a07f0637aa7f45b47af" id="r_a8e0bc782678f9a07f0637aa7f45b47af"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a8e0bc782678f9a07f0637aa7f45b47af">crypto_chacha20_ietf</a> (uint8_t *cipher_text, const uint8_t *plain_text, size_t text_size, const uint8_t key[32], const uint8_t nonce[12], uint32_t ctr)</td></tr>
<tr class="separator:a8e0bc782678f9a07f0637aa7f45b47af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae017f4493a65e8b4a3d6a1c8b8c2ffdf" id="r_ae017f4493a65e8b4a3d6a1c8b8c2ffdf"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#ae017f4493a65e8b4a3d6a1c8b8c2ffdf">crypto_chacha20_x</a> (uint8_t *cipher_text, const uint8_t *plain_text, size_t text_size, const uint8_t key[32], const uint8_t nonce[24], uint64_t ctr)</td></tr>
<tr class="separator:ae017f4493a65e8b4a3d6a1c8b8c2ffdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfece78aacd1fd68115a5e9c516d561b" id="r_adfece78aacd1fd68115a5e9c516d561b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#adfece78aacd1fd68115a5e9c516d561b">crypto_poly1305</a> (uint8_t mac[16], const uint8_t *message, size_t message_size, const uint8_t key[32])</td></tr>
<tr class="separator:adfece78aacd1fd68115a5e9c516d561b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab57b18d15a8b049b18d899a51d732d9a" id="r_ab57b18d15a8b049b18d899a51d732d9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#ab57b18d15a8b049b18d899a51d732d9a">crypto_poly1305_init</a> (<a class="el" href="structcrypto__poly1305__ctx.html">crypto_poly1305_ctx</a> *ctx, const uint8_t key[32])</td></tr>
<tr class="separator:ab57b18d15a8b049b18d899a51d732d9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ff664f4e2cb7c8a41f584018c41646a" id="r_a9ff664f4e2cb7c8a41f584018c41646a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a9ff664f4e2cb7c8a41f584018c41646a">crypto_poly1305_update</a> (<a class="el" href="structcrypto__poly1305__ctx.html">crypto_poly1305_ctx</a> *ctx, const uint8_t *message, size_t message_size)</td></tr>
<tr class="separator:a9ff664f4e2cb7c8a41f584018c41646a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2db62a502fd2224f633778369e56a893" id="r_a2db62a502fd2224f633778369e56a893"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a2db62a502fd2224f633778369e56a893">crypto_poly1305_final</a> (<a class="el" href="structcrypto__poly1305__ctx.html">crypto_poly1305_ctx</a> *ctx, uint8_t mac[16])</td></tr>
<tr class="separator:a2db62a502fd2224f633778369e56a893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e809923727fdb1e97d3f738aa574f54" id="r_a8e809923727fdb1e97d3f738aa574f54"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a8e809923727fdb1e97d3f738aa574f54">crypto_elligator_map</a> (uint8_t curve[32], const uint8_t hidden[32])</td></tr>
<tr class="separator:a8e809923727fdb1e97d3f738aa574f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa38de4751de3c8bbba7e5fd015093ff1" id="r_aa38de4751de3c8bbba7e5fd015093ff1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#aa38de4751de3c8bbba7e5fd015093ff1">crypto_elligator_rev</a> (uint8_t hidden[32], const uint8_t curve[32], uint8_t tweak)</td></tr>
<tr class="separator:aa38de4751de3c8bbba7e5fd015093ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc46bf25a4fe3640f27541d2511eec97" id="r_afc46bf25a4fe3640f27541d2511eec97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#afc46bf25a4fe3640f27541d2511eec97">crypto_elligator_key_pair</a> (uint8_t hidden[32], uint8_t secret_key[32], uint8_t seed[32])</td></tr>
<tr class="separator:afc46bf25a4fe3640f27541d2511eec97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a28788739438f137fc99bddeb3188efee" id="r_a28788739438f137fc99bddeb3188efee"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structcrypto__argon2__extras.html">crypto_argon2_extras</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="monocypher_8h.html#a28788739438f137fc99bddeb3188efee">crypto_argon2_no_extras</a></td></tr>
<tr class="separator:a28788739438f137fc99bddeb3188efee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afaa7bd239e123ac2924f7df35cbd045a" name="afaa7bd239e123ac2924f7df35cbd045a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afaa7bd239e123ac2924f7df35cbd045a">&#9670;&#160;</a></span>CRYPTO_ARGON2_D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_ARGON2_D&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8h_source.html#l00154">154</a> of file <a class="el" href="monocypher_8h_source.html">monocypher.h</a>.</p>

</div>
</div>
<a id="ad9b8a0eed4244d4002f72afc61a6152c" name="ad9b8a0eed4244d4002f72afc61a6152c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9b8a0eed4244d4002f72afc61a6152c">&#9670;&#160;</a></span>CRYPTO_ARGON2_I</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_ARGON2_I&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8h_source.html#l00155">155</a> of file <a class="el" href="monocypher_8h_source.html">monocypher.h</a>.</p>

</div>
</div>
<a id="ad22d01244500852db18539f17716eb0f" name="ad22d01244500852db18539f17716eb0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad22d01244500852db18539f17716eb0f">&#9670;&#160;</a></span>CRYPTO_ARGON2_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_ARGON2_ID&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8h_source.html#l00156">156</a> of file <a class="el" href="monocypher_8h_source.html">monocypher.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8a86991bc2860a264f3e0f2edabc1cd1" name="a8a86991bc2860a264f3e0f2edabc1cd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a86991bc2860a264f3e0f2edabc1cd1">&#9670;&#160;</a></span>crypto_aead_init_djb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_aead_init_djb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nonce</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02888">2888</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2890</span>{</div>
<div class="line"><span class="lineno"> 2891</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">key</a>  , key  , 32);</div>
<div class="line"><span class="lineno"> 2892</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a07c0c0b11cc1518903a9238bcb45da7e">nonce</a>, nonce,  8);</div>
<div class="line"><span class="lineno"> 2893</span>    ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a49dffeb8e409aa66cb427e0bfc43e6ec">counter</a> = 0;</div>
<div class="line"><span class="lineno"> 2894</span>}</div>
<div class="ttc" id="amonocypher_8c_html_aed003a32e5f74ca9773a89fd44088569"><div class="ttname"><a href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a></div><div class="ttdeci">#define COPY(dst, src, size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00065">monocypher.c:65</a></div></div>
<div class="ttc" id="astructcrypto__aead__ctx_html_a07c0c0b11cc1518903a9238bcb45da7e"><div class="ttname"><a href="structcrypto__aead__ctx.html#a07c0c0b11cc1518903a9238bcb45da7e">crypto_aead_ctx::nonce</a></div><div class="ttdeci">uint8_t nonce[8]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00100">monocypher.h:100</a></div></div>
<div class="ttc" id="astructcrypto__aead__ctx_html_a49dffeb8e409aa66cb427e0bfc43e6ec"><div class="ttname"><a href="structcrypto__aead__ctx.html#a49dffeb8e409aa66cb427e0bfc43e6ec">crypto_aead_ctx::counter</a></div><div class="ttdeci">uint64_t counter</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00098">monocypher.h:98</a></div></div>
<div class="ttc" id="astructcrypto__aead__ctx_html_ae6c8f35ba14ced3997cfac5c1cb57eef"><div class="ttname"><a href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">crypto_aead_ctx::key</a></div><div class="ttdeci">uint8_t key[32]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00099">monocypher.h:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71737acb039bbd757d29566b456301bb" name="a71737acb039bbd757d29566b456301bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71737acb039bbd757d29566b456301bb">&#9670;&#160;</a></span>crypto_aead_init_ietf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_aead_init_ietf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nonce</em>[12]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02896">2896</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2898</span>{</div>
<div class="line"><span class="lineno"> 2899</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">key</a>  , key      , 32);</div>
<div class="line"><span class="lineno"> 2900</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a07c0c0b11cc1518903a9238bcb45da7e">nonce</a>, nonce + 4,  8);</div>
<div class="line"><span class="lineno"> 2901</span>    ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a49dffeb8e409aa66cb427e0bfc43e6ec">counter</a> = (<a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>)load32_le(nonce) &lt;&lt; 32;</div>
<div class="line"><span class="lineno"> 2902</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a3f7e2bcbb0b4c338f3c4f6c937cd4234"><div class="ttname"><a href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a></div><div class="ttdeci">uint64_t u64</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00078">monocypher.c:78</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d02172c8b002b202948420c81ad833e" name="a7d02172c8b002b202948420c81ad833e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d02172c8b002b202948420c81ad833e">&#9670;&#160;</a></span>crypto_aead_init_x()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_aead_init_x </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nonce</em>[24]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02880">2880</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2882</span>{</div>
<div class="line"><span class="lineno"> 2883</span>    <a class="code hl_function" href="monocypher_8c.html#ae341138aa59f09b551bbda75c9523553">crypto_chacha20_h</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">key</a>, key, nonce);</div>
<div class="line"><span class="lineno"> 2884</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a07c0c0b11cc1518903a9238bcb45da7e">nonce</a>, nonce + 16, 8);</div>
<div class="line"><span class="lineno"> 2885</span>    ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a49dffeb8e409aa66cb427e0bfc43e6ec">counter</a> = 0;</div>
<div class="line"><span class="lineno"> 2886</span>}</div>
<div class="ttc" id="amonocypher_8c_html_ae341138aa59f09b551bbda75c9523553"><div class="ttname"><a href="monocypher_8c.html#ae341138aa59f09b551bbda75c9523553">crypto_chacha20_h</a></div><div class="ttdeci">void crypto_chacha20_h(u8 out[32], const u8 key[32], const u8 in[16])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00204">monocypher.c:204</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad43cc3eabc0ca0d57e9a2c7e8cb3a531" name="ad43cc3eabc0ca0d57e9a2c7e8cb3a531"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad43cc3eabc0ca0d57e9a2c7e8cb3a531">&#9670;&#160;</a></span>crypto_aead_lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_aead_lock </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mac</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nonce</em>[24], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ad_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>text_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02936">2936</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2939</span>{</div>
<div class="line"><span class="lineno"> 2940</span>    <a class="code hl_struct" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> ctx;</div>
<div class="line"><span class="lineno"> 2941</span>    <a class="code hl_function" href="monocypher_8c.html#a99bb526e85cb5ac8763b3e14efa041ad">crypto_aead_init_x</a>(&amp;ctx, key, nonce);</div>
<div class="line"><span class="lineno"> 2942</span>    <a class="code hl_function" href="monocypher_8c.html#af7955c5939185566d5f26e407300ee33">crypto_aead_write</a>(&amp;ctx, cipher_text, mac, ad, ad_size,</div>
<div class="line"><span class="lineno"> 2943</span>                      plain_text, text_size);</div>
<div class="line"><span class="lineno"> 2944</span>    <a class="code hl_function" href="monocypher_8c.html#a84904a8f94da26863cb33a9375c0a63a">crypto_wipe</a>(&amp;ctx, <span class="keyword">sizeof</span>(ctx));</div>
<div class="line"><span class="lineno"> 2945</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a84904a8f94da26863cb33a9375c0a63a"><div class="ttname"><a href="monocypher_8c.html#a84904a8f94da26863cb33a9375c0a63a">crypto_wipe</a></div><div class="ttdeci">void crypto_wipe(void *secret, size_t size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00163">monocypher.c:163</a></div></div>
<div class="ttc" id="amonocypher_8c_html_a99bb526e85cb5ac8763b3e14efa041ad"><div class="ttname"><a href="monocypher_8c.html#a99bb526e85cb5ac8763b3e14efa041ad">crypto_aead_init_x</a></div><div class="ttdeci">void crypto_aead_init_x(crypto_aead_ctx *ctx, u8 const key[32], const u8 nonce[24])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l02880">monocypher.c:2880</a></div></div>
<div class="ttc" id="amonocypher_8c_html_af7955c5939185566d5f26e407300ee33"><div class="ttname"><a href="monocypher_8c.html#af7955c5939185566d5f26e407300ee33">crypto_aead_write</a></div><div class="ttdeci">void crypto_aead_write(crypto_aead_ctx *ctx, u8 *cipher_text, u8 mac[16], const u8 *ad, size_t ad_size, const u8 *plain_text, size_t text_size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l02904">monocypher.c:2904</a></div></div>
<div class="ttc" id="astructcrypto__aead__ctx_html"><div class="ttname"><a href="structcrypto__aead__ctx.html">crypto_aead_ctx</a></div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00097">monocypher.h:97</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a962568f81b3dead6deb7a7df9d446954" name="a962568f81b3dead6deb7a7df9d446954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a962568f81b3dead6deb7a7df9d446954">&#9670;&#160;</a></span>crypto_aead_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto_aead_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>mac</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ad_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>text_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02917">2917</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2920</span>{</div>
<div class="line"><span class="lineno"> 2921</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> auth_key[64]; <span class="comment">// the last 32 bytes are used for rekeying.</span></div>
<div class="line"><span class="lineno"> 2922</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> real_mac[16];</div>
<div class="line"><span class="lineno"> 2923</span>    <a class="code hl_function" href="monocypher_8c.html#a56808226a52141d0abf422c651a8de62">crypto_chacha20_djb</a>(auth_key, 0, 64, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">key</a>, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a07c0c0b11cc1518903a9238bcb45da7e">nonce</a>, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a49dffeb8e409aa66cb427e0bfc43e6ec">counter</a>);</div>
<div class="line"><span class="lineno"> 2924</span>    lock_auth(real_mac, auth_key, ad, ad_size, cipher_text, text_size);</div>
<div class="line"><span class="lineno"> 2925</span>    <span class="keywordtype">int</span> mismatch = <a class="code hl_function" href="monocypher_8c.html#a2f387f76030d5e7ed3014319053ab25b">crypto_verify16</a>(mac, real_mac);</div>
<div class="line"><span class="lineno"> 2926</span>    <span class="keywordflow">if</span> (!mismatch) {</div>
<div class="line"><span class="lineno"> 2927</span>        <a class="code hl_function" href="monocypher_8c.html#a56808226a52141d0abf422c651a8de62">crypto_chacha20_djb</a>(plain_text, cipher_text, text_size,</div>
<div class="line"><span class="lineno"> 2928</span>                            ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">key</a>, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a07c0c0b11cc1518903a9238bcb45da7e">nonce</a>, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a49dffeb8e409aa66cb427e0bfc43e6ec">counter</a> + 1);</div>
<div class="line"><span class="lineno"> 2929</span>        <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">key</a>, auth_key + 32, 32);</div>
<div class="line"><span class="lineno"> 2930</span>    }</div>
<div class="line"><span class="lineno"> 2931</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(auth_key);</div>
<div class="line"><span class="lineno"> 2932</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(real_mac);</div>
<div class="line"><span class="lineno"> 2933</span>    <span class="keywordflow">return</span> mismatch;</div>
<div class="line"><span class="lineno"> 2934</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a2f387f76030d5e7ed3014319053ab25b"><div class="ttname"><a href="monocypher_8c.html#a2f387f76030d5e7ed3014319053ab25b">crypto_verify16</a></div><div class="ttdeci">int crypto_verify16(const u8 a[16], const u8 b[16])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00159">monocypher.c:159</a></div></div>
<div class="ttc" id="amonocypher_8c_html_a56808226a52141d0abf422c651a8de62"><div class="ttname"><a href="monocypher_8c.html#a56808226a52141d0abf422c651a8de62">crypto_chacha20_djb</a></div><div class="ttdeci">u64 crypto_chacha20_djb(u8 *cipher_text, const u8 *plain_text, size_t text_size, const u8 key[32], const u8 nonce[8], u64 ctr)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00219">monocypher.c:219</a></div></div>
<div class="ttc" id="amonocypher_8c_html_a92c50087ca0e64fa93fc59402c55f8ca"><div class="ttname"><a href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a></div><div class="ttdeci">uint8_t u8</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00073">monocypher.c:73</a></div></div>
<div class="ttc" id="amonocypher_8c_html_afd8dec8072750d9351368c9261684eb8"><div class="ttname"><a href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a></div><div class="ttdeci">#define WIPE_BUFFER(buffer)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00068">monocypher.c:68</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aecb4ce9a3f4def034e7479260a37d95c" name="aecb4ce9a3f4def034e7479260a37d95c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecb4ce9a3f4def034e7479260a37d95c">&#9670;&#160;</a></span>crypto_aead_unlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto_aead_unlock </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>plain_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>mac</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nonce</em>[24], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ad_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>text_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02947">2947</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2950</span>{</div>
<div class="line"><span class="lineno"> 2951</span>    <a class="code hl_struct" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> ctx;</div>
<div class="line"><span class="lineno"> 2952</span>    <a class="code hl_function" href="monocypher_8c.html#a99bb526e85cb5ac8763b3e14efa041ad">crypto_aead_init_x</a>(&amp;ctx, key, nonce);</div>
<div class="line"><span class="lineno"> 2953</span>    <span class="keywordtype">int</span> mismatch = <a class="code hl_function" href="monocypher_8c.html#af2aaa2d868afc45d28efb71555ce41a8">crypto_aead_read</a>(&amp;ctx, plain_text, mac, ad, ad_size,</div>
<div class="line"><span class="lineno"> 2954</span>                                    cipher_text, text_size);</div>
<div class="line"><span class="lineno"> 2955</span>    <a class="code hl_function" href="monocypher_8c.html#a84904a8f94da26863cb33a9375c0a63a">crypto_wipe</a>(&amp;ctx, <span class="keyword">sizeof</span>(ctx));</div>
<div class="line"><span class="lineno"> 2956</span>    <span class="keywordflow">return</span> mismatch;</div>
<div class="line"><span class="lineno"> 2957</span>}</div>
<div class="ttc" id="amonocypher_8c_html_af2aaa2d868afc45d28efb71555ce41a8"><div class="ttname"><a href="monocypher_8c.html#af2aaa2d868afc45d28efb71555ce41a8">crypto_aead_read</a></div><div class="ttdeci">int crypto_aead_read(crypto_aead_ctx *ctx, u8 *plain_text, const u8 mac[16], const u8 *ad, size_t ad_size, const u8 *cipher_text, size_t text_size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l02917">monocypher.c:2917</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f68322e3e6936bb9e5cc0dd61bc7056" name="a4f68322e3e6936bb9e5cc0dd61bc7056"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f68322e3e6936bb9e5cc0dd61bc7056">&#9670;&#160;</a></span>crypto_aead_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_aead_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__aead__ctx.html">crypto_aead_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mac</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ad_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>text_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02904">2904</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2907</span>{</div>
<div class="line"><span class="lineno"> 2908</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> auth_key[64]; <span class="comment">// the last 32 bytes are used for rekeying.</span></div>
<div class="line"><span class="lineno"> 2909</span>    <a class="code hl_function" href="monocypher_8c.html#a56808226a52141d0abf422c651a8de62">crypto_chacha20_djb</a>(auth_key, 0, 64, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">key</a>, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a07c0c0b11cc1518903a9238bcb45da7e">nonce</a>, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a49dffeb8e409aa66cb427e0bfc43e6ec">counter</a>);</div>
<div class="line"><span class="lineno"> 2910</span>    <a class="code hl_function" href="monocypher_8c.html#a56808226a52141d0abf422c651a8de62">crypto_chacha20_djb</a>(cipher_text, plain_text, text_size,</div>
<div class="line"><span class="lineno"> 2911</span>                        ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">key</a>, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a07c0c0b11cc1518903a9238bcb45da7e">nonce</a>, ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#a49dffeb8e409aa66cb427e0bfc43e6ec">counter</a> + 1);</div>
<div class="line"><span class="lineno"> 2912</span>    lock_auth(mac, auth_key, ad, ad_size, cipher_text, text_size);</div>
<div class="line"><span class="lineno"> 2913</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__aead__ctx.html#ae6c8f35ba14ced3997cfac5c1cb57eef">key</a>, auth_key + 32, 32);</div>
<div class="line"><span class="lineno"> 2914</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(auth_key);</div>
<div class="line"><span class="lineno"> 2915</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a84587b689d53a4382b0f94ffb67bd2cb" name="a84587b689d53a4382b0f94ffb67bd2cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84587b689d53a4382b0f94ffb67bd2cb">&#9670;&#160;</a></span>crypto_argon2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_argon2 </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>work_area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__argon2__config.html">crypto_argon2_config</a>&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__argon2__inputs.html">crypto_argon2_inputs</a>&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__argon2__extras.html">crypto_argon2_extras</a>&#160;</td>
          <td class="paramname"><em>extras</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00758">758</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  762</span>{</div>
<div class="line"><span class="lineno">  763</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> segment_size = config.<a class="code hl_variable" href="structcrypto__argon2__config.html#a471a487b69171aa193c396401d4c7996">nb_blocks</a> / config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aed034d1afd5300f8c6136078d9688ddf">nb_lanes</a> / 4;</div>
<div class="line"><span class="lineno">  764</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> lane_size    = segment_size * 4;</div>
<div class="line"><span class="lineno">  765</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> nb_blocks    = lane_size * config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aed034d1afd5300f8c6136078d9688ddf">nb_lanes</a>; <span class="comment">// rounding down</span></div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    <span class="comment">// work area seen as blocks (must be suitably aligned)</span></div>
<div class="line"><span class="lineno">  768</span>    <a class="code hl_struct" href="structblk.html">blk</a> *blocks = (<a class="code hl_struct" href="structblk.html">blk</a>*)work_area;</div>
<div class="line"><span class="lineno">  769</span>    {</div>
<div class="line"><span class="lineno">  770</span>        <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> initial_hash[72]; <span class="comment">// 64 bytes plus 2 words for future hashes</span></div>
<div class="line"><span class="lineno">  771</span>        <a class="code hl_struct" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> ctx;</div>
<div class="line"><span class="lineno">  772</span>        <a class="code hl_function" href="monocypher_8c.html#a7ffa93aca7473a69cc440680c4951026">crypto_blake2b_init</a> (&amp;ctx, 64);</div>
<div class="line"><span class="lineno">  773</span>        blake_update_32     (&amp;ctx, config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aed034d1afd5300f8c6136078d9688ddf">nb_lanes</a> ); <span class="comment">// p: number of &quot;threads&quot;</span></div>
<div class="line"><span class="lineno">  774</span>        blake_update_32     (&amp;ctx, hash_size);</div>
<div class="line"><span class="lineno">  775</span>        blake_update_32     (&amp;ctx, config.<a class="code hl_variable" href="structcrypto__argon2__config.html#a471a487b69171aa193c396401d4c7996">nb_blocks</a>);</div>
<div class="line"><span class="lineno">  776</span>        blake_update_32     (&amp;ctx, config.<a class="code hl_variable" href="structcrypto__argon2__config.html#a76513c31c70057be018b7fd9e1ba2885">nb_passes</a>);</div>
<div class="line"><span class="lineno">  777</span>        blake_update_32     (&amp;ctx, 0x13);             <span class="comment">// v: version number</span></div>
<div class="line"><span class="lineno">  778</span>        blake_update_32     (&amp;ctx, config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aafc75e8e35d3ef63cd0c9e04a5d94033">algorithm</a>); <span class="comment">// y: Argon2i, Argon2d...</span></div>
<div class="line"><span class="lineno">  779</span>        blake_update_32_buf (&amp;ctx, inputs.<a class="code hl_variable" href="structcrypto__argon2__inputs.html#a8a969b49a23b754c0e5185f49a8e9acd">pass</a>, inputs.<a class="code hl_variable" href="structcrypto__argon2__inputs.html#ae90ede961c775ad16cc6ac7a2897542d">pass_size</a>);</div>
<div class="line"><span class="lineno">  780</span>        blake_update_32_buf (&amp;ctx, inputs.<a class="code hl_variable" href="structcrypto__argon2__inputs.html#a14979f0ea14b7c95828b455baa382f9a">salt</a>, inputs.<a class="code hl_variable" href="structcrypto__argon2__inputs.html#a2278ad37abee35f6fae69cbd27b90549">salt_size</a>);</div>
<div class="line"><span class="lineno">  781</span>        blake_update_32_buf (&amp;ctx, extras.<a class="code hl_variable" href="structcrypto__argon2__extras.html#a70695f8a5197b4dade2e662ee45a3504">key</a>,  extras.<a class="code hl_variable" href="structcrypto__argon2__extras.html#a062dc6736f3e2183c15d14c4257083f0">key_size</a>);</div>
<div class="line"><span class="lineno">  782</span>        blake_update_32_buf (&amp;ctx, extras.<a class="code hl_variable" href="structcrypto__argon2__extras.html#acbe6753cf5192d0cd2caf5378957c6b0">ad</a>,   extras.<a class="code hl_variable" href="structcrypto__argon2__extras.html#aa66f39debe284415c191adb189249db0">ad_size</a>);</div>
<div class="line"><span class="lineno">  783</span>        <a class="code hl_function" href="monocypher_8c.html#a1422c3757f13d228c1ac3dc936490c62">crypto_blake2b_final</a>(&amp;ctx, initial_hash); <span class="comment">// fill 64 first bytes only</span></div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>        <span class="comment">// fill first 2 blocks of each lane</span></div>
<div class="line"><span class="lineno">  786</span>        <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> hash_area[1024];</div>
<div class="line"><span class="lineno">  787</span>        <a class="code hl_define" href="monocypher_8c.html#a07fe98f84cf1fe008e7cb3eda126b859">FOR_T</a>(<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>, l, 0, config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aed034d1afd5300f8c6136078d9688ddf">nb_lanes</a>) {</div>
<div class="line"><span class="lineno">  788</span>            <a class="code hl_define" href="monocypher_8c.html#a07fe98f84cf1fe008e7cb3eda126b859">FOR_T</a>(<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>, i, 0, 2) {</div>
<div class="line"><span class="lineno">  789</span>                store32_le(initial_hash + 64, i); <span class="comment">// first  additional word</span></div>
<div class="line"><span class="lineno">  790</span>                store32_le(initial_hash + 68, l); <span class="comment">// second additional word</span></div>
<div class="line"><span class="lineno">  791</span>                extended_hash(hash_area, 1024, initial_hash, 72);</div>
<div class="line"><span class="lineno">  792</span>                load64_le_buf(blocks[l * lane_size + i].a, hash_area, 128);</div>
<div class="line"><span class="lineno">  793</span>            }</div>
<div class="line"><span class="lineno">  794</span>        }</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>        <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(initial_hash);</div>
<div class="line"><span class="lineno">  797</span>        <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(hash_area);</div>
<div class="line"><span class="lineno">  798</span>    }</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>    <span class="comment">// Argon2i and Argon2id start with constant time indexing</span></div>
<div class="line"><span class="lineno">  801</span>    <span class="keywordtype">int</span> constant_time = config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aafc75e8e35d3ef63cd0c9e04a5d94033">algorithm</a> != <a class="code hl_define" href="monocypher_8h.html#afaa7bd239e123ac2924f7df35cbd045a">CRYPTO_ARGON2_D</a>;</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>    <span class="comment">// Fill (and re-fill) the rest of the blocks</span></div>
<div class="line"><span class="lineno">  804</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  805</span>    <span class="comment">// Note: even though each segment within the same slice can be</span></div>
<div class="line"><span class="lineno">  806</span>    <span class="comment">// computed in parallel, (one thread per lane), we are computing</span></div>
<div class="line"><span class="lineno">  807</span>    <span class="comment">// them sequentially, because Monocypher doesn&#39;t support threads.</span></div>
<div class="line"><span class="lineno">  808</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  809</span>    <span class="comment">// Yet optimal performance (and therefore security) requires one</span></div>
<div class="line"><span class="lineno">  810</span>    <span class="comment">// thread per lane. The only reason Monocypher supports multiple</span></div>
<div class="line"><span class="lineno">  811</span>    <span class="comment">// lanes is compatibility.</span></div>
<div class="line"><span class="lineno">  812</span>    <a class="code hl_struct" href="structblk.html">blk</a> tmp;</div>
<div class="line"><span class="lineno">  813</span>    <a class="code hl_define" href="monocypher_8c.html#a07fe98f84cf1fe008e7cb3eda126b859">FOR_T</a>(<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>, pass, 0, config.<a class="code hl_variable" href="structcrypto__argon2__config.html#a76513c31c70057be018b7fd9e1ba2885">nb_passes</a>) {</div>
<div class="line"><span class="lineno">  814</span>        <a class="code hl_define" href="monocypher_8c.html#a07fe98f84cf1fe008e7cb3eda126b859">FOR_T</a>(<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>, slice, 0, 4) {</div>
<div class="line"><span class="lineno">  815</span>            <span class="comment">// On the first slice of the first pass,</span></div>
<div class="line"><span class="lineno">  816</span>            <span class="comment">// blocks 0 and 1 are already filled, hence pass_offset.</span></div>
<div class="line"><span class="lineno">  817</span>            <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> pass_offset  = pass == 0 &amp;&amp; slice == 0 ? 2 : 0;</div>
<div class="line"><span class="lineno">  818</span>            <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> slice_offset = slice * segment_size;</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>            <span class="comment">// Argon2id switches back to non-constant time indexing</span></div>
<div class="line"><span class="lineno">  821</span>            <span class="comment">// after the first two slices of the first pass</span></div>
<div class="line"><span class="lineno">  822</span>            <span class="keywordflow">if</span> (slice == 2 &amp;&amp; config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aafc75e8e35d3ef63cd0c9e04a5d94033">algorithm</a> == <a class="code hl_define" href="monocypher_8h.html#ad22d01244500852db18539f17716eb0f">CRYPTO_ARGON2_ID</a>) {</div>
<div class="line"><span class="lineno">  823</span>                constant_time = 0;</div>
<div class="line"><span class="lineno">  824</span>            }</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>            <span class="comment">// Each iteration of the following loop may be performed in</span></div>
<div class="line"><span class="lineno">  827</span>            <span class="comment">// a separate thread.  All segments must be fully completed</span></div>
<div class="line"><span class="lineno">  828</span>            <span class="comment">// before we start filling the next slice.</span></div>
<div class="line"><span class="lineno">  829</span>            <a class="code hl_define" href="monocypher_8c.html#a07fe98f84cf1fe008e7cb3eda126b859">FOR_T</a>(<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>, segment, 0, config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aed034d1afd5300f8c6136078d9688ddf">nb_lanes</a>) {</div>
<div class="line"><span class="lineno">  830</span>                <a class="code hl_struct" href="structblk.html">blk</a> index_block;</div>
<div class="line"><span class="lineno">  831</span>                <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> index_ctr = 1;</div>
<div class="line"><span class="lineno">  832</span>                <a class="code hl_define" href="monocypher_8c.html#a07fe98f84cf1fe008e7cb3eda126b859">FOR_T</a> (<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>, block, pass_offset, segment_size) {</div>
<div class="line"><span class="lineno">  833</span>                    <span class="comment">// Current and previous blocks</span></div>
<div class="line"><span class="lineno">  834</span>                    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>  lane_offset   = segment * lane_size;</div>
<div class="line"><span class="lineno">  835</span>                    <a class="code hl_struct" href="structblk.html">blk</a> *segment_start = blocks + lane_offset + slice_offset;</div>
<div class="line"><span class="lineno">  836</span>                    <a class="code hl_struct" href="structblk.html">blk</a> *current       = segment_start + block;</div>
<div class="line"><span class="lineno">  837</span>                    <a class="code hl_struct" href="structblk.html">blk</a> *previous      =</div>
<div class="line"><span class="lineno">  838</span>                        block == 0 &amp;&amp; slice_offset == 0</div>
<div class="line"><span class="lineno">  839</span>                        ? segment_start + lane_size - 1</div>
<div class="line"><span class="lineno">  840</span>                        : segment_start + block - 1;</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>                    <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a> index_seed;</div>
<div class="line"><span class="lineno">  843</span>                    <span class="keywordflow">if</span> (constant_time) {</div>
<div class="line"><span class="lineno">  844</span>                        <span class="keywordflow">if</span> (block == pass_offset || (block % 128) == 0) {</div>
<div class="line"><span class="lineno">  845</span>                            <span class="comment">// Fill or refresh deterministic indices block</span></div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>                            <span class="comment">// seed the beginning of the block...</span></div>
<div class="line"><span class="lineno">  848</span>                            <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(index_block.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>, 128);</div>
<div class="line"><span class="lineno">  849</span>                            index_block.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>[0] = pass;</div>
<div class="line"><span class="lineno">  850</span>                            index_block.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>[1] = segment;</div>
<div class="line"><span class="lineno">  851</span>                            index_block.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>[2] = slice;</div>
<div class="line"><span class="lineno">  852</span>                            index_block.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>[3] = nb_blocks;</div>
<div class="line"><span class="lineno">  853</span>                            index_block.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>[4] = config.<a class="code hl_variable" href="structcrypto__argon2__config.html#a76513c31c70057be018b7fd9e1ba2885">nb_passes</a>;</div>
<div class="line"><span class="lineno">  854</span>                            index_block.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>[5] = config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aafc75e8e35d3ef63cd0c9e04a5d94033">algorithm</a>;</div>
<div class="line"><span class="lineno">  855</span>                            index_block.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>[6] = index_ctr;</div>
<div class="line"><span class="lineno">  856</span>                            index_ctr++;</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>                            <span class="comment">// ... then shuffle it</span></div>
<div class="line"><span class="lineno">  859</span>                            copy_block(&amp;tmp, &amp;index_block);</div>
<div class="line"><span class="lineno">  860</span>                            g_rounds  (&amp;index_block);</div>
<div class="line"><span class="lineno">  861</span>                            xor_block (&amp;index_block, &amp;tmp);</div>
<div class="line"><span class="lineno">  862</span>                            copy_block(&amp;tmp, &amp;index_block);</div>
<div class="line"><span class="lineno">  863</span>                            g_rounds  (&amp;index_block);</div>
<div class="line"><span class="lineno">  864</span>                            xor_block (&amp;index_block, &amp;tmp);</div>
<div class="line"><span class="lineno">  865</span>                        }</div>
<div class="line"><span class="lineno">  866</span>                        index_seed = index_block.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>[block % 128];</div>
<div class="line"><span class="lineno">  867</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  868</span>                        index_seed = previous-&gt;<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>[0];</div>
<div class="line"><span class="lineno">  869</span>                    }</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>                    <span class="comment">// Establish the reference set.  *Approximately* comprises:</span></div>
<div class="line"><span class="lineno">  872</span>                    <span class="comment">// - The last 3 slices (if they exist yet)</span></div>
<div class="line"><span class="lineno">  873</span>                    <span class="comment">// - The already constructed blocks in the current segment</span></div>
<div class="line"><span class="lineno">  874</span>                    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> next_slice   = ((slice + 1) % 4) * segment_size;</div>
<div class="line"><span class="lineno">  875</span>                    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> window_start = pass == 0 ? 0     : next_slice;</div>
<div class="line"><span class="lineno">  876</span>                    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> nb_segments  = pass == 0 ? slice : 3;</div>
<div class="line"><span class="lineno">  877</span>                    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> window_size  = nb_segments * segment_size + block - 1;</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>                    <span class="comment">// Find reference block</span></div>
<div class="line"><span class="lineno">  880</span>                    <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>  j1        = index_seed &amp; 0xffffffff; <span class="comment">// block selector</span></div>
<div class="line"><span class="lineno">  881</span>                    <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>  j2        = index_seed &gt;&gt; 32;        <span class="comment">// lane selector</span></div>
<div class="line"><span class="lineno">  882</span>                    <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>  x         = (j1 * j1)         &gt;&gt; 32;</div>
<div class="line"><span class="lineno">  883</span>                    <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>  y         = (window_size * x) &gt;&gt; 32;</div>
<div class="line"><span class="lineno">  884</span>                    <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>  z         = (window_size - 1) - y;</div>
<div class="line"><span class="lineno">  885</span>                    <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>  ref       = (window_start + z) % lane_size;</div>
<div class="line"><span class="lineno">  886</span>                    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>  index     = (j2%config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aed034d1afd5300f8c6136078d9688ddf">nb_lanes</a>)*lane_size + (<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>)ref;</div>
<div class="line"><span class="lineno">  887</span>                    <a class="code hl_struct" href="structblk.html">blk</a> *reference = blocks + index;</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>                    <span class="comment">// Shuffle the previous &amp; reference block</span></div>
<div class="line"><span class="lineno">  890</span>                    <span class="comment">// into the current block</span></div>
<div class="line"><span class="lineno">  891</span>                    copy_block(&amp;tmp, previous);</div>
<div class="line"><span class="lineno">  892</span>                    xor_block (&amp;tmp, reference);</div>
<div class="line"><span class="lineno">  893</span>                    <span class="keywordflow">if</span> (pass == 0) { copy_block(current, &amp;tmp); }</div>
<div class="line"><span class="lineno">  894</span>                    <span class="keywordflow">else</span>           { xor_block (current, &amp;tmp); }</div>
<div class="line"><span class="lineno">  895</span>                    g_rounds  (&amp;tmp);</div>
<div class="line"><span class="lineno">  896</span>                    xor_block (current, &amp;tmp);</div>
<div class="line"><span class="lineno">  897</span>                }</div>
<div class="line"><span class="lineno">  898</span>            }</div>
<div class="line"><span class="lineno">  899</span>        }</div>
<div class="line"><span class="lineno">  900</span>    }</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>    <span class="comment">// Wipe temporary block</span></div>
<div class="line"><span class="lineno">  903</span>    <span class="keyword">volatile</span> <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>* p = tmp.<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>;</div>
<div class="line"><span class="lineno">  904</span>    <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(p, 128);</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>    <span class="comment">// XOR last blocks of each lane</span></div>
<div class="line"><span class="lineno">  907</span>    <a class="code hl_struct" href="structblk.html">blk</a> *last_block = blocks + lane_size - 1;</div>
<div class="line"><span class="lineno">  908</span>    <a class="code hl_define" href="monocypher_8c.html#a07fe98f84cf1fe008e7cb3eda126b859">FOR_T</a> (<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>, lane, 1, config.<a class="code hl_variable" href="structcrypto__argon2__config.html#aed034d1afd5300f8c6136078d9688ddf">nb_lanes</a>) {</div>
<div class="line"><span class="lineno">  909</span>        <a class="code hl_struct" href="structblk.html">blk</a> *next_block = last_block + lane_size;</div>
<div class="line"><span class="lineno">  910</span>        xor_block(next_block, last_block);</div>
<div class="line"><span class="lineno">  911</span>        last_block = next_block;</div>
<div class="line"><span class="lineno">  912</span>    }</div>
<div class="line"><span class="lineno">  913</span> </div>
<div class="line"><span class="lineno">  914</span>    <span class="comment">// Serialize last block</span></div>
<div class="line"><span class="lineno">  915</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> final_block[1024];</div>
<div class="line"><span class="lineno">  916</span>    store64_le_buf(final_block, last_block-&gt;<a class="code hl_variable" href="structblk.html#a5e28980c4c851a07427a45df2f890450">a</a>, 128);</div>
<div class="line"><span class="lineno">  917</span> </div>
<div class="line"><span class="lineno">  918</span>    <span class="comment">// Wipe work area</span></div>
<div class="line"><span class="lineno">  919</span>    p = (<a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>*)work_area;</div>
<div class="line"><span class="lineno">  920</span>    <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(p, 128 * nb_blocks);</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>    <span class="comment">// Hash the very last block with H&#39; into the output hash</span></div>
<div class="line"><span class="lineno">  923</span>    extended_hash(hash, hash_size, final_block, 1024);</div>
<div class="line"><span class="lineno">  924</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(final_block);</div>
<div class="line"><span class="lineno">  925</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a07fe98f84cf1fe008e7cb3eda126b859"><div class="ttname"><a href="monocypher_8c.html#a07fe98f84cf1fe008e7cb3eda126b859">FOR_T</a></div><div class="ttdeci">#define FOR_T(type, i, start, end)</div><div class="ttdoc">Utilities ///.</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00063">monocypher.c:63</a></div></div>
<div class="ttc" id="amonocypher_8c_html_a1422c3757f13d228c1ac3dc936490c62"><div class="ttname"><a href="monocypher_8c.html#a1422c3757f13d228c1ac3dc936490c62">crypto_blake2b_final</a></div><div class="ttdeci">void crypto_blake2b_final(crypto_blake2b_ctx *ctx, u8 *hash)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00637">monocypher.c:637</a></div></div>
<div class="ttc" id="amonocypher_8c_html_a7ffa93aca7473a69cc440680c4951026"><div class="ttname"><a href="monocypher_8c.html#a7ffa93aca7473a69cc440680c4951026">crypto_blake2b_init</a></div><div class="ttdeci">void crypto_blake2b_init(crypto_blake2b_ctx *ctx, size_t hash_size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00564">monocypher.c:564</a></div></div>
<div class="ttc" id="amonocypher_8c_html_adc347ca4ca98f82fa1b041a76a01672a"><div class="ttname"><a href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a></div><div class="ttdeci">#define ZERO(buf, size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00066">monocypher.c:66</a></div></div>
<div class="ttc" id="amonocypher_8c_html_afaa62991928fb9fb18ff0db62a040aba"><div class="ttname"><a href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a></div><div class="ttdeci">uint32_t u32</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00075">monocypher.c:75</a></div></div>
<div class="ttc" id="amonocypher_8h_html_ad22d01244500852db18539f17716eb0f"><div class="ttname"><a href="monocypher_8h.html#ad22d01244500852db18539f17716eb0f">CRYPTO_ARGON2_ID</a></div><div class="ttdeci">#define CRYPTO_ARGON2_ID</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00156">monocypher.h:156</a></div></div>
<div class="ttc" id="amonocypher_8h_html_afaa7bd239e123ac2924f7df35cbd045a"><div class="ttname"><a href="monocypher_8h.html#afaa7bd239e123ac2924f7df35cbd045a">CRYPTO_ARGON2_D</a></div><div class="ttdeci">#define CRYPTO_ARGON2_D</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00154">monocypher.h:154</a></div></div>
<div class="ttc" id="astructblk_html"><div class="ttname"><a href="structblk.html">blk</a></div><div class="ttdoc">Argon2 ///.</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00670">monocypher.c:670</a></div></div>
<div class="ttc" id="astructblk_html_a5e28980c4c851a07427a45df2f890450"><div class="ttname"><a href="structblk.html#a5e28980c4c851a07427a45df2f890450">blk::a</a></div><div class="ttdeci">u64 a[128]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00670">monocypher.c:670</a></div></div>
<div class="ttc" id="astructcrypto__argon2__config_html_a471a487b69171aa193c396401d4c7996"><div class="ttname"><a href="structcrypto__argon2__config.html#a471a487b69171aa193c396401d4c7996">crypto_argon2_config::nb_blocks</a></div><div class="ttdeci">uint32_t nb_blocks</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00160">monocypher.h:160</a></div></div>
<div class="ttc" id="astructcrypto__argon2__config_html_a76513c31c70057be018b7fd9e1ba2885"><div class="ttname"><a href="structcrypto__argon2__config.html#a76513c31c70057be018b7fd9e1ba2885">crypto_argon2_config::nb_passes</a></div><div class="ttdeci">uint32_t nb_passes</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00161">monocypher.h:161</a></div></div>
<div class="ttc" id="astructcrypto__argon2__config_html_aafc75e8e35d3ef63cd0c9e04a5d94033"><div class="ttname"><a href="structcrypto__argon2__config.html#aafc75e8e35d3ef63cd0c9e04a5d94033">crypto_argon2_config::algorithm</a></div><div class="ttdeci">uint32_t algorithm</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00159">monocypher.h:159</a></div></div>
<div class="ttc" id="astructcrypto__argon2__config_html_aed034d1afd5300f8c6136078d9688ddf"><div class="ttname"><a href="structcrypto__argon2__config.html#aed034d1afd5300f8c6136078d9688ddf">crypto_argon2_config::nb_lanes</a></div><div class="ttdeci">uint32_t nb_lanes</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00162">monocypher.h:162</a></div></div>
<div class="ttc" id="astructcrypto__argon2__extras_html_a062dc6736f3e2183c15d14c4257083f0"><div class="ttname"><a href="structcrypto__argon2__extras.html#a062dc6736f3e2183c15d14c4257083f0">crypto_argon2_extras::key_size</a></div><div class="ttdeci">uint32_t key_size</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00175">monocypher.h:175</a></div></div>
<div class="ttc" id="astructcrypto__argon2__extras_html_a70695f8a5197b4dade2e662ee45a3504"><div class="ttname"><a href="structcrypto__argon2__extras.html#a70695f8a5197b4dade2e662ee45a3504">crypto_argon2_extras::key</a></div><div class="ttdeci">const uint8_t * key</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00173">monocypher.h:173</a></div></div>
<div class="ttc" id="astructcrypto__argon2__extras_html_aa66f39debe284415c191adb189249db0"><div class="ttname"><a href="structcrypto__argon2__extras.html#aa66f39debe284415c191adb189249db0">crypto_argon2_extras::ad_size</a></div><div class="ttdeci">uint32_t ad_size</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00176">monocypher.h:176</a></div></div>
<div class="ttc" id="astructcrypto__argon2__extras_html_acbe6753cf5192d0cd2caf5378957c6b0"><div class="ttname"><a href="structcrypto__argon2__extras.html#acbe6753cf5192d0cd2caf5378957c6b0">crypto_argon2_extras::ad</a></div><div class="ttdeci">const uint8_t * ad</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00174">monocypher.h:174</a></div></div>
<div class="ttc" id="astructcrypto__argon2__inputs_html_a14979f0ea14b7c95828b455baa382f9a"><div class="ttname"><a href="structcrypto__argon2__inputs.html#a14979f0ea14b7c95828b455baa382f9a">crypto_argon2_inputs::salt</a></div><div class="ttdeci">const uint8_t * salt</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00167">monocypher.h:167</a></div></div>
<div class="ttc" id="astructcrypto__argon2__inputs_html_a2278ad37abee35f6fae69cbd27b90549"><div class="ttname"><a href="structcrypto__argon2__inputs.html#a2278ad37abee35f6fae69cbd27b90549">crypto_argon2_inputs::salt_size</a></div><div class="ttdeci">uint32_t salt_size</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00169">monocypher.h:169</a></div></div>
<div class="ttc" id="astructcrypto__argon2__inputs_html_a8a969b49a23b754c0e5185f49a8e9acd"><div class="ttname"><a href="structcrypto__argon2__inputs.html#a8a969b49a23b754c0e5185f49a8e9acd">crypto_argon2_inputs::pass</a></div><div class="ttdeci">const uint8_t * pass</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00166">monocypher.h:166</a></div></div>
<div class="ttc" id="astructcrypto__argon2__inputs_html_ae90ede961c775ad16cc6ac7a2897542d"><div class="ttname"><a href="structcrypto__argon2__inputs.html#ae90ede961c775ad16cc6ac7a2897542d">crypto_argon2_inputs::pass_size</a></div><div class="ttdeci">uint32_t pass_size</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00168">monocypher.h:168</a></div></div>
<div class="ttc" id="astructcrypto__blake2b__ctx_html"><div class="ttname"><a href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a></div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00134">monocypher.h:134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16aa7d4b3ac7d423a95e8385e605ed1b" name="a16aa7d4b3ac7d423a95e8385e605ed1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16aa7d4b3ac7d423a95e8385e605ed1b">&#9670;&#160;</a></span>crypto_blake2b()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_blake2b </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00659">659</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  660</span>{</div>
<div class="line"><span class="lineno">  661</span>    <a class="code hl_function" href="monocypher_8c.html#a5a1dd8ddab4f2f4122ba80a8ab42d75b">crypto_blake2b_keyed</a>(hash, hash_size, 0, 0, msg, msg_size);</div>
<div class="line"><span class="lineno">  662</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a5a1dd8ddab4f2f4122ba80a8ab42d75b"><div class="ttname"><a href="monocypher_8c.html#a5a1dd8ddab4f2f4122ba80a8ab42d75b">crypto_blake2b_keyed</a></div><div class="ttdeci">void crypto_blake2b_keyed(u8 *hash, size_t hash_size, const u8 *key, size_t key_size, const u8 *message, size_t message_size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00649">monocypher.c:649</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa719a90928706c86e00d08781924c050" name="aa719a90928706c86e00d08781924c050"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa719a90928706c86e00d08781924c050">&#9670;&#160;</a></span>crypto_blake2b_final()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_blake2b_final </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00637">637</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  638</span>{</div>
<div class="line"><span class="lineno">  639</span>    blake2b_compress(ctx, 1); <span class="comment">// compress the last block</span></div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordtype">size_t</span> hash_size = <a class="code hl_define" href="monocypher_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a5be265b70bd75a5805d9ef990f0c62e9">hash_size</a>, 64);</div>
<div class="line"><span class="lineno">  641</span>    <span class="keywordtype">size_t</span> nb_words  = hash_size &gt;&gt; 3;</div>
<div class="line"><span class="lineno">  642</span>    store64_le_buf(hash, ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#abe66db226cb001e586de2ef42063e33a">hash</a>, nb_words);</div>
<div class="line"><span class="lineno">  643</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, nb_words &lt;&lt; 3, hash_size) {</div>
<div class="line"><span class="lineno">  644</span>        hash[i] = (ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#abe66db226cb001e586de2ef42063e33a">hash</a>[i &gt;&gt; 3] &gt;&gt; (8 * (i &amp; 7))) &amp; 0xff;</div>
<div class="line"><span class="lineno">  645</span>    }</div>
<div class="line"><span class="lineno">  646</span>    <a class="code hl_define" href="monocypher_8c.html#a2ec2a7ea97bf6be30be6f129bf1f8159">WIPE_CTX</a>(ctx);</div>
<div class="line"><span class="lineno">  647</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a2ec2a7ea97bf6be30be6f129bf1f8159"><div class="ttname"><a href="monocypher_8c.html#a2ec2a7ea97bf6be30be6f129bf1f8159">WIPE_CTX</a></div><div class="ttdeci">#define WIPE_CTX(ctx)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00067">monocypher.c:67</a></div></div>
<div class="ttc" id="amonocypher_8c_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="monocypher_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00069">monocypher.c:69</a></div></div>
<div class="ttc" id="amonocypher_8c_html_a7193936d00c5176808a87b6142ba10c3"><div class="ttname"><a href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a></div><div class="ttdeci">#define FOR(i, start, end)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00064">monocypher.c:64</a></div></div>
<div class="ttc" id="astructcrypto__blake2b__ctx_html_a5be265b70bd75a5805d9ef990f0c62e9"><div class="ttname"><a href="structcrypto__blake2b__ctx.html#a5be265b70bd75a5805d9ef990f0c62e9">crypto_blake2b_ctx::hash_size</a></div><div class="ttdeci">size_t hash_size</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00141">monocypher.h:141</a></div></div>
<div class="ttc" id="astructcrypto__blake2b__ctx_html_abe66db226cb001e586de2ef42063e33a"><div class="ttname"><a href="structcrypto__blake2b__ctx.html#abe66db226cb001e586de2ef42063e33a">crypto_blake2b_ctx::hash</a></div><div class="ttdeci">uint64_t hash[8]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00137">monocypher.h:137</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ffa93aca7473a69cc440680c4951026" name="a7ffa93aca7473a69cc440680c4951026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ffa93aca7473a69cc440680c4951026">&#9670;&#160;</a></span>crypto_blake2b_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_blake2b_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00564">564</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  565</span>{</div>
<div class="line"><span class="lineno">  566</span>    <a class="code hl_function" href="monocypher_8c.html#a60bd082f576523e713412c7ec795d502">crypto_blake2b_keyed_init</a>(ctx, hash_size, 0, 0);</div>
<div class="line"><span class="lineno">  567</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a60bd082f576523e713412c7ec795d502"><div class="ttname"><a href="monocypher_8c.html#a60bd082f576523e713412c7ec795d502">crypto_blake2b_keyed_init</a></div><div class="ttdeci">void crypto_blake2b_keyed_init(crypto_blake2b_ctx *ctx, size_t hash_size, const u8 *key, size_t key_size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00541">monocypher.c:541</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a15866e182bfaf0419bbda3a5c94b6f45" name="a15866e182bfaf0419bbda3a5c94b6f45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15866e182bfaf0419bbda3a5c94b6f45">&#9670;&#160;</a></span>crypto_blake2b_keyed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_blake2b_keyed </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00649">649</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  652</span>{</div>
<div class="line"><span class="lineno">  653</span>    <a class="code hl_struct" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> ctx;</div>
<div class="line"><span class="lineno">  654</span>    <a class="code hl_function" href="monocypher_8c.html#a60bd082f576523e713412c7ec795d502">crypto_blake2b_keyed_init</a>(&amp;ctx, hash_size, key, key_size);</div>
<div class="line"><span class="lineno">  655</span>    <a class="code hl_function" href="monocypher_8c.html#a0d11738421fa5018ed0ec03e434c1274">crypto_blake2b_update</a>    (&amp;ctx, message, message_size);</div>
<div class="line"><span class="lineno">  656</span>    <a class="code hl_function" href="monocypher_8c.html#a1422c3757f13d228c1ac3dc936490c62">crypto_blake2b_final</a>     (&amp;ctx, hash);</div>
<div class="line"><span class="lineno">  657</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a0d11738421fa5018ed0ec03e434c1274"><div class="ttname"><a href="monocypher_8c.html#a0d11738421fa5018ed0ec03e434c1274">crypto_blake2b_update</a></div><div class="ttdeci">void crypto_blake2b_update(crypto_blake2b_ctx *ctx, const u8 *message, size_t message_size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00569">monocypher.c:569</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a26a700af95a409458781b0e24090c27a" name="a26a700af95a409458781b0e24090c27a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26a700af95a409458781b0e24090c27a">&#9670;&#160;</a></span>crypto_blake2b_keyed_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_blake2b_keyed_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00541">541</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  543</span>{</div>
<div class="line"><span class="lineno">  544</span>    <span class="comment">// initial hash</span></div>
<div class="line"><span class="lineno">  545</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#abe66db226cb001e586de2ef42063e33a">hash</a>, iv, 8);</div>
<div class="line"><span class="lineno">  546</span>    ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#abe66db226cb001e586de2ef42063e33a">hash</a>[0] ^= 0x01010000 ^ (key_size &lt;&lt; 8) ^ hash_size;</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>    ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a4077cfe0f3a7fc78b9d8849c8b4c3029">input_offset</a>[0] = 0;  <span class="comment">// beginning of the input, no offset</span></div>
<div class="line"><span class="lineno">  549</span>    ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a4077cfe0f3a7fc78b9d8849c8b4c3029">input_offset</a>[1] = 0;  <span class="comment">// beginning of the input, no offset</span></div>
<div class="line"><span class="lineno">  550</span>    ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a5be265b70bd75a5805d9ef990f0c62e9">hash_size</a>       = hash_size;</div>
<div class="line"><span class="lineno">  551</span>    ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a>       = 0;</div>
<div class="line"><span class="lineno">  552</span>    <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a0e2ce486775ace6ae6ad2b459f8ac132">input</a>, 16);</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>    <span class="comment">// if there is a key, the first block is that key (padded with zeroes)</span></div>
<div class="line"><span class="lineno">  555</span>    <span class="keywordflow">if</span> (key_size &gt; 0) {</div>
<div class="line"><span class="lineno">  556</span>        <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> key_block[128] = {0};</div>
<div class="line"><span class="lineno">  557</span>        <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(key_block, key, key_size);</div>
<div class="line"><span class="lineno">  558</span>        <span class="comment">// same as calling crypto_blake2b_update(ctx, key_block , 128)</span></div>
<div class="line"><span class="lineno">  559</span>        load64_le_buf(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a0e2ce486775ace6ae6ad2b459f8ac132">input</a>, key_block, 16);</div>
<div class="line"><span class="lineno">  560</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> = 128;</div>
<div class="line"><span class="lineno">  561</span>    }</div>
<div class="line"><span class="lineno">  562</span>}</div>
<div class="ttc" id="astructcrypto__blake2b__ctx_html_a0e2ce486775ace6ae6ad2b459f8ac132"><div class="ttname"><a href="structcrypto__blake2b__ctx.html#a0e2ce486775ace6ae6ad2b459f8ac132">crypto_blake2b_ctx::input</a></div><div class="ttdeci">uint64_t input[16]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00139">monocypher.h:139</a></div></div>
<div class="ttc" id="astructcrypto__blake2b__ctx_html_a2c9e5004f527918a9fa9beb42540f9aa"><div class="ttname"><a href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">crypto_blake2b_ctx::input_idx</a></div><div class="ttdeci">size_t input_idx</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00140">monocypher.h:140</a></div></div>
<div class="ttc" id="astructcrypto__blake2b__ctx_html_a4077cfe0f3a7fc78b9d8849c8b4c3029"><div class="ttname"><a href="structcrypto__blake2b__ctx.html#a4077cfe0f3a7fc78b9d8849c8b4c3029">crypto_blake2b_ctx::input_offset</a></div><div class="ttdeci">uint64_t input_offset[2]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00138">monocypher.h:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95aa6264859b5fff2623a731876aa15e" name="a95aa6264859b5fff2623a731876aa15e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95aa6264859b5fff2623a731876aa15e">&#9670;&#160;</a></span>crypto_blake2b_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_blake2b_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__blake2b__ctx.html">crypto_blake2b_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00569">569</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  571</span>{</div>
<div class="line"><span class="lineno">  572</span>    <span class="comment">// Avoid undefined NULL pointer increments with empty messages</span></div>
<div class="line"><span class="lineno">  573</span>    <span class="keywordflow">if</span> (message_size == 0) {</div>
<div class="line"><span class="lineno">  574</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>    <span class="comment">// Align with word boundaries</span></div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">if</span> ((ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> &amp; 7) != 0) {</div>
<div class="line"><span class="lineno">  579</span>        <span class="keywordtype">size_t</span> nb_bytes = <a class="code hl_define" href="monocypher_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(align(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a>, 8), message_size);</div>
<div class="line"><span class="lineno">  580</span>        <span class="keywordtype">size_t</span> word     = ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> &gt;&gt; 3;</div>
<div class="line"><span class="lineno">  581</span>        <span class="keywordtype">size_t</span> <span class="keywordtype">byte</span>     = ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> &amp; 7;</div>
<div class="line"><span class="lineno">  582</span>        <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, nb_bytes) {</div>
<div class="line"><span class="lineno">  583</span>            ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a0e2ce486775ace6ae6ad2b459f8ac132">input</a>[word] |= (<a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>)message[i] &lt;&lt; ((<span class="keywordtype">byte</span> + i) &lt;&lt; 3);</div>
<div class="line"><span class="lineno">  584</span>        }</div>
<div class="line"><span class="lineno">  585</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> += nb_bytes;</div>
<div class="line"><span class="lineno">  586</span>        message        += nb_bytes;</div>
<div class="line"><span class="lineno">  587</span>        message_size   -= nb_bytes;</div>
<div class="line"><span class="lineno">  588</span>    }</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>    <span class="comment">// Align with block boundaries (faster than byte by byte)</span></div>
<div class="line"><span class="lineno">  591</span>    <span class="keywordflow">if</span> ((ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> &amp; 127) != 0) {</div>
<div class="line"><span class="lineno">  592</span>        <span class="keywordtype">size_t</span> nb_words = <a class="code hl_define" href="monocypher_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(align(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a>, 128), message_size) &gt;&gt; 3;</div>
<div class="line"><span class="lineno">  593</span>        load64_le_buf(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a0e2ce486775ace6ae6ad2b459f8ac132">input</a> + (ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> &gt;&gt; 3), message, nb_words);</div>
<div class="line"><span class="lineno">  594</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> += nb_words &lt;&lt; 3;</div>
<div class="line"><span class="lineno">  595</span>        message        += nb_words &lt;&lt; 3;</div>
<div class="line"><span class="lineno">  596</span>        message_size   -= nb_words &lt;&lt; 3;</div>
<div class="line"><span class="lineno">  597</span>    }</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    <span class="comment">// Process block by block</span></div>
<div class="line"><span class="lineno">  600</span>    <span class="keywordtype">size_t</span> nb_blocks = message_size &gt;&gt; 7;</div>
<div class="line"><span class="lineno">  601</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, nb_blocks) {</div>
<div class="line"><span class="lineno">  602</span>        <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> == 128) {</div>
<div class="line"><span class="lineno">  603</span>            blake2b_compress(ctx, 0);</div>
<div class="line"><span class="lineno">  604</span>        }</div>
<div class="line"><span class="lineno">  605</span>        load64_le_buf(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a0e2ce486775ace6ae6ad2b459f8ac132">input</a>, message, 16);</div>
<div class="line"><span class="lineno">  606</span>        message += 128;</div>
<div class="line"><span class="lineno">  607</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> = 128;</div>
<div class="line"><span class="lineno">  608</span>    }</div>
<div class="line"><span class="lineno">  609</span>    message_size &amp;= 127;</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>    <span class="keywordflow">if</span> (message_size != 0) {</div>
<div class="line"><span class="lineno">  612</span>        <span class="comment">// Compress block &amp; flush input buffer as needed</span></div>
<div class="line"><span class="lineno">  613</span>        <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> == 128) {</div>
<div class="line"><span class="lineno">  614</span>            blake2b_compress(ctx, 0);</div>
<div class="line"><span class="lineno">  615</span>            ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> = 0;</div>
<div class="line"><span class="lineno">  616</span>        }</div>
<div class="line"><span class="lineno">  617</span>        <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> == 0) {</div>
<div class="line"><span class="lineno">  618</span>            <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a0e2ce486775ace6ae6ad2b459f8ac132">input</a>, 16);</div>
<div class="line"><span class="lineno">  619</span>        }</div>
<div class="line"><span class="lineno">  620</span>        <span class="comment">// Fill remaining words (faster than byte by byte)</span></div>
<div class="line"><span class="lineno">  621</span>        <span class="keywordtype">size_t</span> nb_words = message_size &gt;&gt; 3;</div>
<div class="line"><span class="lineno">  622</span>        load64_le_buf(ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a0e2ce486775ace6ae6ad2b459f8ac132">input</a>, message, nb_words);</div>
<div class="line"><span class="lineno">  623</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> += nb_words &lt;&lt; 3;</div>
<div class="line"><span class="lineno">  624</span>        message        += nb_words &lt;&lt; 3;</div>
<div class="line"><span class="lineno">  625</span>        message_size   -= nb_words &lt;&lt; 3;</div>
<div class="line"><span class="lineno">  626</span> </div>
<div class="line"><span class="lineno">  627</span>        <span class="comment">// Fill remaining bytes</span></div>
<div class="line"><span class="lineno">  628</span>        <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, message_size) {</div>
<div class="line"><span class="lineno">  629</span>            <span class="keywordtype">size_t</span> word = ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> &gt;&gt; 3;</div>
<div class="line"><span class="lineno">  630</span>            <span class="keywordtype">size_t</span> <span class="keywordtype">byte</span> = ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a> &amp; 7;</div>
<div class="line"><span class="lineno">  631</span>            ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a0e2ce486775ace6ae6ad2b459f8ac132">input</a>[word] |= (<a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>)message[i] &lt;&lt; (<span class="keywordtype">byte</span> &lt;&lt; 3);</div>
<div class="line"><span class="lineno">  632</span>            ctx-&gt;<a class="code hl_variable" href="structcrypto__blake2b__ctx.html#a2c9e5004f527918a9fa9beb42540f9aa">input_idx</a>++;</div>
<div class="line"><span class="lineno">  633</span>        }</div>
<div class="line"><span class="lineno">  634</span>    }</div>
<div class="line"><span class="lineno">  635</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7976df9d72c90b050613197806acd3a" name="aa7976df9d72c90b050613197806acd3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7976df9d72c90b050613197806acd3a">&#9670;&#160;</a></span>crypto_chacha20_djb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t crypto_chacha20_djb </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>text_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nonce</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>ctr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00219">219</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  222</span>{</div>
<div class="line"><span class="lineno">  223</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> input[16];</div>
<div class="line"><span class="lineno">  224</span>    load32_le_buf(input     , chacha20_constant, 4);</div>
<div class="line"><span class="lineno">  225</span>    load32_le_buf(input +  4, key              , 8);</div>
<div class="line"><span class="lineno">  226</span>    load32_le_buf(input + 14, nonce            , 2);</div>
<div class="line"><span class="lineno">  227</span>    input[12] = (<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>) ctr;</div>
<div class="line"><span class="lineno">  228</span>    input[13] = (<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>)(ctr &gt;&gt; 32);</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="comment">// Whole blocks</span></div>
<div class="line"><span class="lineno">  231</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>    pool[16];</div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordtype">size_t</span> nb_blocks = text_size &gt;&gt; 6;</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, nb_blocks) {</div>
<div class="line"><span class="lineno">  234</span>        chacha20_rounds(pool, input);</div>
<div class="line"><span class="lineno">  235</span>        <span class="keywordflow">if</span> (plain_text != 0) {</div>
<div class="line"><span class="lineno">  236</span>            <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (j, 0, 16) {</div>
<div class="line"><span class="lineno">  237</span>                <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> p = pool[j] + input[j];</div>
<div class="line"><span class="lineno">  238</span>                store32_le(cipher_text, p ^ load32_le(plain_text));</div>
<div class="line"><span class="lineno">  239</span>                cipher_text += 4;</div>
<div class="line"><span class="lineno">  240</span>                plain_text  += 4;</div>
<div class="line"><span class="lineno">  241</span>            }</div>
<div class="line"><span class="lineno">  242</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  243</span>            <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (j, 0, 16) {</div>
<div class="line"><span class="lineno">  244</span>                <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> p = pool[j] + input[j];</div>
<div class="line"><span class="lineno">  245</span>                store32_le(cipher_text, p);</div>
<div class="line"><span class="lineno">  246</span>                cipher_text += 4;</div>
<div class="line"><span class="lineno">  247</span>            }</div>
<div class="line"><span class="lineno">  248</span>        }</div>
<div class="line"><span class="lineno">  249</span>        input[12]++;</div>
<div class="line"><span class="lineno">  250</span>        <span class="keywordflow">if</span> (input[12] == 0) {</div>
<div class="line"><span class="lineno">  251</span>            input[13]++;</div>
<div class="line"><span class="lineno">  252</span>        }</div>
<div class="line"><span class="lineno">  253</span>    }</div>
<div class="line"><span class="lineno">  254</span>    text_size &amp;= 63;</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="comment">// Last (incomplete) block</span></div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">if</span> (text_size &gt; 0) {</div>
<div class="line"><span class="lineno">  258</span>        <span class="keywordflow">if</span> (plain_text == 0) {</div>
<div class="line"><span class="lineno">  259</span>            plain_text = zero;</div>
<div class="line"><span class="lineno">  260</span>        }</div>
<div class="line"><span class="lineno">  261</span>        chacha20_rounds(pool, input);</div>
<div class="line"><span class="lineno">  262</span>        <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> tmp[64];</div>
<div class="line"><span class="lineno">  263</span>        <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, 16) {</div>
<div class="line"><span class="lineno">  264</span>            store32_le(tmp + i*4, pool[i] + input[i]);</div>
<div class="line"><span class="lineno">  265</span>        }</div>
<div class="line"><span class="lineno">  266</span>        <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, text_size) {</div>
<div class="line"><span class="lineno">  267</span>            cipher_text[i] = tmp[i] ^ plain_text[i];</div>
<div class="line"><span class="lineno">  268</span>        }</div>
<div class="line"><span class="lineno">  269</span>        <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(tmp);</div>
<div class="line"><span class="lineno">  270</span>    }</div>
<div class="line"><span class="lineno">  271</span>    ctr = input[12] + ((<a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>)input[13] &lt;&lt; 32) + (text_size &gt; 0);</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(pool);</div>
<div class="line"><span class="lineno">  274</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(input);</div>
<div class="line"><span class="lineno">  275</span>    <span class="keywordflow">return</span> ctr;</div>
<div class="line"><span class="lineno">  276</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af524b38e04a09fc0ecc86bebb5011bd9" name="af524b38e04a09fc0ecc86bebb5011bd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af524b38e04a09fc0ecc86bebb5011bd9">&#9670;&#160;</a></span>crypto_chacha20_h()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_chacha20_h </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>out</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>in</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00204">204</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  205</span>{</div>
<div class="line"><span class="lineno">  206</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> block[16];</div>
<div class="line"><span class="lineno">  207</span>    load32_le_buf(block     , chacha20_constant, 4);</div>
<div class="line"><span class="lineno">  208</span>    load32_le_buf(block +  4, key              , 8);</div>
<div class="line"><span class="lineno">  209</span>    load32_le_buf(block + 12, in               , 4);</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>    chacha20_rounds(block, block);</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="comment">// prevent reversal of the rounds by revealing only half of the buffer.</span></div>
<div class="line"><span class="lineno">  214</span>    store32_le_buf(out   , block   , 4); <span class="comment">// constant</span></div>
<div class="line"><span class="lineno">  215</span>    store32_le_buf(out+16, block+12, 4); <span class="comment">// counter and nonce</span></div>
<div class="line"><span class="lineno">  216</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(block);</div>
<div class="line"><span class="lineno">  217</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e0bc782678f9a07f0637aa7f45b47af" name="a8e0bc782678f9a07f0637aa7f45b47af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e0bc782678f9a07f0637aa7f45b47af">&#9670;&#160;</a></span>crypto_chacha20_ietf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t crypto_chacha20_ietf </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>text_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nonce</em>[12], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ctr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00278">278</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  281</span>{</div>
<div class="line"><span class="lineno">  282</span>    <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a> big_ctr = ctr + ((<a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>)load32_le(nonce) &lt;&lt; 32);</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">return</span> (<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>)<a class="code hl_function" href="monocypher_8c.html#a56808226a52141d0abf422c651a8de62">crypto_chacha20_djb</a>(cipher_text, plain_text, text_size,</div>
<div class="line"><span class="lineno">  284</span>                                    key, nonce + 4, big_ctr);</div>
<div class="line"><span class="lineno">  285</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae017f4493a65e8b4a3d6a1c8b8c2ffdf" name="ae017f4493a65e8b4a3d6a1c8b8c2ffdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae017f4493a65e8b4a3d6a1c8b8c2ffdf">&#9670;&#160;</a></span>crypto_chacha20_x()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t crypto_chacha20_x </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cipher_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>plain_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>text_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nonce</em>[24], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>ctr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00287">287</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  290</span>{</div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> sub_key[32];</div>
<div class="line"><span class="lineno">  292</span>    <a class="code hl_function" href="monocypher_8c.html#ae341138aa59f09b551bbda75c9523553">crypto_chacha20_h</a>(sub_key, key, nonce);</div>
<div class="line"><span class="lineno">  293</span>    ctr = <a class="code hl_function" href="monocypher_8c.html#a56808226a52141d0abf422c651a8de62">crypto_chacha20_djb</a>(cipher_text, plain_text, text_size,</div>
<div class="line"><span class="lineno">  294</span>                              sub_key, nonce + 16, ctr);</div>
<div class="line"><span class="lineno">  295</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(sub_key);</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">return</span> ctr;</div>
<div class="line"><span class="lineno">  297</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e202116983caacc8a0c8488c715760b" name="a7e202116983caacc8a0c8488c715760b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e202116983caacc8a0c8488c715760b">&#9670;&#160;</a></span>crypto_eddsa_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto_eddsa_check </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>signature</em>[64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>public_key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02336">2336</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2338</span>{</div>
<div class="line"><span class="lineno"> 2339</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> h[32];</div>
<div class="line"><span class="lineno"> 2340</span>    hash_reduce(h, signature, 32, public_key, 32, message, message_size);</div>
<div class="line"><span class="lineno"> 2341</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="monocypher_8c.html#a185ecbf5412ed77c74f3441aed4f6918">crypto_eddsa_check_equation</a>(signature, public_key, h);</div>
<div class="line"><span class="lineno"> 2342</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a185ecbf5412ed77c74f3441aed4f6918"><div class="ttname"><a href="monocypher_8c.html#a185ecbf5412ed77c74f3441aed4f6918">crypto_eddsa_check_equation</a></div><div class="ttdeci">int crypto_eddsa_check_equation(const u8 signature[64], const u8 public_key[32], const u8 h[32])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01973">monocypher.c:1973</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3aa5f875e129881fb044f0c5c1f92bbe" name="a3aa5f875e129881fb044f0c5c1f92bbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aa5f875e129881fb044f0c5c1f92bbe">&#9670;&#160;</a></span>crypto_eddsa_check_equation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto_eddsa_check_equation </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>signature</em>[64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>public_key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>h_ram</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l01973">1973</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1975</span>{</div>
<div class="line"><span class="lineno"> 1976</span>    <a class="code hl_struct" href="structge.html">ge</a> minus_A; <span class="comment">// -public_key</span></div>
<div class="line"><span class="lineno"> 1977</span>    <a class="code hl_struct" href="structge.html">ge</a> minus_R; <span class="comment">// -first_half_of_signature</span></div>
<div class="line"><span class="lineno"> 1978</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> *s = signature + 32;</div>
<div class="line"><span class="lineno"> 1979</span> </div>
<div class="line"><span class="lineno"> 1980</span>    <span class="comment">// Check that A and R are on the curve</span></div>
<div class="line"><span class="lineno"> 1981</span>    <span class="comment">// Check that 0 &lt;= S &lt; L (prevents malleability)</span></div>
<div class="line"><span class="lineno"> 1982</span>    <span class="comment">// *Allow* non-cannonical encoding for A and R</span></div>
<div class="line"><span class="lineno"> 1983</span>    {</div>
<div class="line"><span class="lineno"> 1984</span>        <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> s32[8];</div>
<div class="line"><span class="lineno"> 1985</span>        load32_le_buf(s32, s, 8);</div>
<div class="line"><span class="lineno"> 1986</span>        <span class="keywordflow">if</span> (ge_frombytes_neg_vartime(&amp;minus_A, public_key) ||</div>
<div class="line"><span class="lineno"> 1987</span>            ge_frombytes_neg_vartime(&amp;minus_R, signature)  ||</div>
<div class="line"><span class="lineno"> 1988</span>            is_above_l(s32)) {</div>
<div class="line"><span class="lineno"> 1989</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1990</span>        }</div>
<div class="line"><span class="lineno"> 1991</span>    }</div>
<div class="line"><span class="lineno"> 1992</span> </div>
<div class="line"><span class="lineno"> 1993</span>    <span class="comment">// look-up table for minus_A</span></div>
<div class="line"><span class="lineno"> 1994</span>    <a class="code hl_struct" href="structge__cached.html">ge_cached</a> lutA[<a class="code hl_define" href="monocypher_8c.html#a303159fd6a9d1642638d6ba07b4592f2">P_W_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1995</span>    {</div>
<div class="line"><span class="lineno"> 1996</span>        <a class="code hl_struct" href="structge.html">ge</a> minus_A2, tmp;</div>
<div class="line"><span class="lineno"> 1997</span>        ge_double(&amp;minus_A2, &amp;minus_A, &amp;tmp);</div>
<div class="line"><span class="lineno"> 1998</span>        ge_cache(&amp;lutA[0], &amp;minus_A);</div>
<div class="line"><span class="lineno"> 1999</span>        <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 1, <a class="code hl_define" href="monocypher_8c.html#a303159fd6a9d1642638d6ba07b4592f2">P_W_SIZE</a>) {</div>
<div class="line"><span class="lineno"> 2000</span>            ge_add(&amp;tmp, &amp;minus_A2, &amp;lutA[i-1]);</div>
<div class="line"><span class="lineno"> 2001</span>            ge_cache(&amp;lutA[i], &amp;tmp);</div>
<div class="line"><span class="lineno"> 2002</span>        }</div>
<div class="line"><span class="lineno"> 2003</span>    }</div>
<div class="line"><span class="lineno"> 2004</span> </div>
<div class="line"><span class="lineno"> 2005</span>    <span class="comment">// sum = [s]B - [h]A</span></div>
<div class="line"><span class="lineno"> 2006</span>    <span class="comment">// Merged double and add ladder, fused with sliding</span></div>
<div class="line"><span class="lineno"> 2007</span>    <a class="code hl_struct" href="structslide__ctx.html">slide_ctx</a> h_slide;  slide_init(&amp;h_slide, h);</div>
<div class="line"><span class="lineno"> 2008</span>    <a class="code hl_struct" href="structslide__ctx.html">slide_ctx</a> s_slide;  slide_init(&amp;s_slide, s);</div>
<div class="line"><span class="lineno"> 2009</span>    <span class="keywordtype">int</span> i = <a class="code hl_define" href="monocypher_8c.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(h_slide.<a class="code hl_variable" href="structslide__ctx.html#a0be1e87f942a92edde7e99f1874ac21c">next_check</a>, s_slide.<a class="code hl_variable" href="structslide__ctx.html#a0be1e87f942a92edde7e99f1874ac21c">next_check</a>);</div>
<div class="line"><span class="lineno"> 2010</span>    <a class="code hl_struct" href="structge.html">ge</a> *sum = &amp;minus_A; <span class="comment">// reuse minus_A for the sum</span></div>
<div class="line"><span class="lineno"> 2011</span>    ge_zero(sum);</div>
<div class="line"><span class="lineno"> 2012</span>    <span class="keywordflow">while</span> (i &gt;= 0) {</div>
<div class="line"><span class="lineno"> 2013</span>        <a class="code hl_struct" href="structge.html">ge</a> tmp;</div>
<div class="line"><span class="lineno"> 2014</span>        ge_double(sum, sum, &amp;tmp);</div>
<div class="line"><span class="lineno"> 2015</span>        <span class="keywordtype">int</span> h_digit = slide_step(&amp;h_slide, <a class="code hl_define" href="monocypher_8c.html#ac89278bac688d8ca5c46fcdbe687e916">P_W_WIDTH</a>, i, h);</div>
<div class="line"><span class="lineno"> 2016</span>        <span class="keywordtype">int</span> s_digit = slide_step(&amp;s_slide, <a class="code hl_define" href="monocypher_8c.html#adfe69d4414b8d82a5eb4f562a50d109a">B_W_WIDTH</a>, i, s);</div>
<div class="line"><span class="lineno"> 2017</span>        <span class="keywordflow">if</span> (h_digit &gt; 0) { ge_add(sum, sum, &amp;lutA[ h_digit / 2]); }</div>
<div class="line"><span class="lineno"> 2018</span>        <span class="keywordflow">if</span> (h_digit &lt; 0) { ge_sub(sum, sum, &amp;lutA[-h_digit / 2]); }</div>
<div class="line"><span class="lineno"> 2019</span>        <a class="code hl_typedef" href="monocypher_8c.html#a939afbd56e733375ca04aff2e4f852ff">fe</a> t1, t2;</div>
<div class="line"><span class="lineno"> 2020</span>        <span class="keywordflow">if</span> (s_digit &gt; 0) { ge_madd(sum, sum, b_window +  s_digit/2, t1, t2); }</div>
<div class="line"><span class="lineno"> 2021</span>        <span class="keywordflow">if</span> (s_digit &lt; 0) { ge_msub(sum, sum, b_window + -s_digit/2, t1, t2); }</div>
<div class="line"><span class="lineno"> 2022</span>        i--;</div>
<div class="line"><span class="lineno"> 2023</span>    }</div>
<div class="line"><span class="lineno"> 2024</span> </div>
<div class="line"><span class="lineno"> 2025</span>    <span class="comment">// Compare [8](sum-R) and the zero point</span></div>
<div class="line"><span class="lineno"> 2026</span>    <span class="comment">// The multiplication by 8 eliminates any low-order component</span></div>
<div class="line"><span class="lineno"> 2027</span>    <span class="comment">// and ensures consistency with batched verification.</span></div>
<div class="line"><span class="lineno"> 2028</span>    <a class="code hl_struct" href="structge__cached.html">ge_cached</a> cached;</div>
<div class="line"><span class="lineno"> 2029</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> check[32];</div>
<div class="line"><span class="lineno"> 2030</span>    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> zero_point[32] = {1}; <span class="comment">// Point of order 1</span></div>
<div class="line"><span class="lineno"> 2031</span>    ge_cache(&amp;cached, &amp;minus_R);</div>
<div class="line"><span class="lineno"> 2032</span>    ge_add(sum, sum, &amp;cached);</div>
<div class="line"><span class="lineno"> 2033</span>    ge_double(sum, sum, &amp;minus_R); <span class="comment">// reuse minus_R as temporary</span></div>
<div class="line"><span class="lineno"> 2034</span>    ge_double(sum, sum, &amp;minus_R); <span class="comment">// reuse minus_R as temporary</span></div>
<div class="line"><span class="lineno"> 2035</span>    ge_double(sum, sum, &amp;minus_R); <span class="comment">// reuse minus_R as temporary</span></div>
<div class="line"><span class="lineno"> 2036</span>    ge_tobytes(check, sum);</div>
<div class="line"><span class="lineno"> 2037</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="monocypher_8c.html#a480a45cbfde604361084c74dcbf87524">crypto_verify32</a>(check, zero_point);</div>
<div class="line"><span class="lineno"> 2038</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a303159fd6a9d1642638d6ba07b4592f2"><div class="ttname"><a href="monocypher_8c.html#a303159fd6a9d1642638d6ba07b4592f2">P_W_SIZE</a></div><div class="ttdeci">#define P_W_SIZE</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01971">monocypher.c:1971</a></div></div>
<div class="ttc" id="amonocypher_8c_html_a480a45cbfde604361084c74dcbf87524"><div class="ttname"><a href="monocypher_8c.html#a480a45cbfde604361084c74dcbf87524">crypto_verify32</a></div><div class="ttdeci">int crypto_verify32(const u8 a[32], const u8 b[32])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00160">monocypher.c:160</a></div></div>
<div class="ttc" id="amonocypher_8c_html_a939afbd56e733375ca04aff2e4f852ff"><div class="ttname"><a href="monocypher_8c.html#a939afbd56e733375ca04aff2e4f852ff">fe</a></div><div class="ttdeci">i32 fe[10]</div><div class="ttdoc">Arithmetic modulo 2^255 - 19 ///.</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00934">monocypher.c:934</a></div></div>
<div class="ttc" id="amonocypher_8c_html_ac89278bac688d8ca5c46fcdbe687e916"><div class="ttname"><a href="monocypher_8c.html#ac89278bac688d8ca5c46fcdbe687e916">P_W_WIDTH</a></div><div class="ttdeci">#define P_W_WIDTH</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01969">monocypher.c:1969</a></div></div>
<div class="ttc" id="amonocypher_8c_html_adfe69d4414b8d82a5eb4f562a50d109a"><div class="ttname"><a href="monocypher_8c.html#adfe69d4414b8d82a5eb4f562a50d109a">B_W_WIDTH</a></div><div class="ttdeci">#define B_W_WIDTH</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01970">monocypher.c:1970</a></div></div>
<div class="ttc" id="amonocypher_8c_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="monocypher_8c.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00070">monocypher.c:70</a></div></div>
<div class="ttc" id="astructge__cached_html"><div class="ttname"><a href="structge__cached.html">ge_cached</a></div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01695">monocypher.c:1695</a></div></div>
<div class="ttc" id="astructge_html"><div class="ttname"><a href="structge.html">ge</a></div><div class="ttdoc">Ed25519 ///.</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01694">monocypher.c:1694</a></div></div>
<div class="ttc" id="astructslide__ctx_html"><div class="ttname"><a href="structslide__ctx.html">slide_ctx</a></div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01916">monocypher.c:1916</a></div></div>
<div class="ttc" id="astructslide__ctx_html_a0be1e87f942a92edde7e99f1874ac21c"><div class="ttname"><a href="structslide__ctx.html#a0be1e87f942a92edde7e99f1874ac21c">slide_ctx::next_check</a></div><div class="ttdeci">u8 next_check</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01919">monocypher.c:1919</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a17524bc5d32fc326a4e52a2daa2e7e19" name="a17524bc5d32fc326a4e52a2daa2e7e19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17524bc5d32fc326a4e52a2daa2e7e19">&#9670;&#160;</a></span>crypto_eddsa_key_pair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_eddsa_key_pair </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>secret_key</em>[64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>public_key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>seed</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02221">2221</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2222</span>{</div>
<div class="line"><span class="lineno"> 2223</span>    <span class="comment">// To allow overlaps, observable writes happen in this order:</span></div>
<div class="line"><span class="lineno"> 2224</span>    <span class="comment">// 1. seed</span></div>
<div class="line"><span class="lineno"> 2225</span>    <span class="comment">// 2. secret_key</span></div>
<div class="line"><span class="lineno"> 2226</span>    <span class="comment">// 3. public_key</span></div>
<div class="line"><span class="lineno"> 2227</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> a[64];</div>
<div class="line"><span class="lineno"> 2228</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(a, seed, 32);</div>
<div class="line"><span class="lineno"> 2229</span>    <a class="code hl_function" href="monocypher_8c.html#a84904a8f94da26863cb33a9375c0a63a">crypto_wipe</a>(seed, 32);</div>
<div class="line"><span class="lineno"> 2230</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(secret_key, a, 32);</div>
<div class="line"><span class="lineno"> 2231</span>    <a class="code hl_function" href="monocypher_8c.html#a1121defb33e0af351020c4f2de6fafd7">crypto_blake2b</a>(a, 64, a, 32);</div>
<div class="line"><span class="lineno"> 2232</span>    <a class="code hl_function" href="monocypher_8c.html#ab5b4a924922762e4c39b93b1dc1a0d50">crypto_eddsa_trim_scalar</a>(a, a);</div>
<div class="line"><span class="lineno"> 2233</span>    <a class="code hl_function" href="monocypher_8c.html#ad2f363aee48f6c6e4b0ea3d14faf6ac2">crypto_eddsa_scalarbase</a>(secret_key + 32, a);</div>
<div class="line"><span class="lineno"> 2234</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(public_key, secret_key + 32, 32);</div>
<div class="line"><span class="lineno"> 2235</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(a);</div>
<div class="line"><span class="lineno"> 2236</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a1121defb33e0af351020c4f2de6fafd7"><div class="ttname"><a href="monocypher_8c.html#a1121defb33e0af351020c4f2de6fafd7">crypto_blake2b</a></div><div class="ttdeci">void crypto_blake2b(u8 *hash, size_t hash_size, const u8 *msg, size_t msg_size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00659">monocypher.c:659</a></div></div>
<div class="ttc" id="amonocypher_8c_html_ab5b4a924922762e4c39b93b1dc1a0d50"><div class="ttname"><a href="monocypher_8c.html#ab5b4a924922762e4c39b93b1dc1a0d50">crypto_eddsa_trim_scalar</a></div><div class="ttdeci">void crypto_eddsa_trim_scalar(u8 out[32], const u8 in[32])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01474">monocypher.c:1474</a></div></div>
<div class="ttc" id="amonocypher_8c_html_ad2f363aee48f6c6e4b0ea3d14faf6ac2"><div class="ttname"><a href="monocypher_8c.html#ad2f363aee48f6c6e4b0ea3d14faf6ac2">crypto_eddsa_scalarbase</a></div><div class="ttdeci">void crypto_eddsa_scalarbase(u8 point[32], const u8 scalar[32])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l02213">monocypher.c:2213</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aab9136f4202134dce3d689ff92aae36d" name="aab9136f4202134dce3d689ff92aae36d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab9136f4202134dce3d689ff92aae36d">&#9670;&#160;</a></span>crypto_eddsa_mul_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_eddsa_mul_add </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>r</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>a</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>b</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>c</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l01672">1672</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1674</span>{</div>
<div class="line"><span class="lineno"> 1675</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> A[8];  load32_le_buf(A, a, 8);</div>
<div class="line"><span class="lineno"> 1676</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> B[8];  load32_le_buf(B, b, 8);</div>
<div class="line"><span class="lineno"> 1677</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> p[16]; load32_le_buf(p, c, 8);  <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(p + 8, 8);</div>
<div class="line"><span class="lineno"> 1678</span>    multiply(p, A, B);</div>
<div class="line"><span class="lineno"> 1679</span>    mod_l(r, p);</div>
<div class="line"><span class="lineno"> 1680</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(p);</div>
<div class="line"><span class="lineno"> 1681</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(A);</div>
<div class="line"><span class="lineno"> 1682</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(B);</div>
<div class="line"><span class="lineno"> 1683</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e7a43edd08e9b4320d1db7579286c97" name="a0e7a43edd08e9b4320d1db7579286c97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e7a43edd08e9b4320d1db7579286c97">&#9670;&#160;</a></span>crypto_eddsa_reduce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_eddsa_reduce </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reduced</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>expanded</em>[64]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l01663">1663</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1664</span>{</div>
<div class="line"><span class="lineno"> 1665</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> x[16];</div>
<div class="line"><span class="lineno"> 1666</span>    load32_le_buf(x, expanded, 16);</div>
<div class="line"><span class="lineno"> 1667</span>    mod_l(reduced, x);</div>
<div class="line"><span class="lineno"> 1668</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(x);</div>
<div class="line"><span class="lineno"> 1669</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a224ab287277af8262e7f6d069ec1d89b" name="a224ab287277af8262e7f6d069ec1d89b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a224ab287277af8262e7f6d069ec1d89b">&#9670;&#160;</a></span>crypto_eddsa_scalarbase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_eddsa_scalarbase </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>point</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>scalar</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02213">2213</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2214</span>{</div>
<div class="line"><span class="lineno"> 2215</span>    <a class="code hl_struct" href="structge.html">ge</a> P;</div>
<div class="line"><span class="lineno"> 2216</span>    ge_scalarmult_base(&amp;P, scalar);</div>
<div class="line"><span class="lineno"> 2217</span>    ge_tobytes(point, &amp;P);</div>
<div class="line"><span class="lineno"> 2218</span>    <a class="code hl_define" href="monocypher_8c.html#a2ec2a7ea97bf6be30be6f129bf1f8159">WIPE_CTX</a>(&amp;P);</div>
<div class="line"><span class="lineno"> 2219</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8aa3f01f65bc3d90f4bb9d81b51287e5" name="a8aa3f01f65bc3d90f4bb9d81b51287e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aa3f01f65bc3d90f4bb9d81b51287e5">&#9670;&#160;</a></span>crypto_eddsa_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_eddsa_sign </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>signature</em>[64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>secret_key</em>[64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02308">2308</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2310</span>{</div>
<div class="line"><span class="lineno"> 2311</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> a[64];  <span class="comment">// secret scalar and prefix</span></div>
<div class="line"><span class="lineno"> 2312</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> r[32];  <span class="comment">// secret deterministic &quot;random&quot; nonce</span></div>
<div class="line"><span class="lineno"> 2313</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> h[32];  <span class="comment">// publically verifiable hash of the message (not wiped)</span></div>
<div class="line"><span class="lineno"> 2314</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> R[32];  <span class="comment">// first half of the signature (allows overlapping inputs)</span></div>
<div class="line"><span class="lineno"> 2315</span> </div>
<div class="line"><span class="lineno"> 2316</span>    <a class="code hl_function" href="monocypher_8c.html#a1121defb33e0af351020c4f2de6fafd7">crypto_blake2b</a>(a, 64, secret_key, 32);</div>
<div class="line"><span class="lineno"> 2317</span>    <a class="code hl_function" href="monocypher_8c.html#ab5b4a924922762e4c39b93b1dc1a0d50">crypto_eddsa_trim_scalar</a>(a, a);</div>
<div class="line"><span class="lineno"> 2318</span>    hash_reduce(r, a + 32, 32, message, message_size, 0, 0);</div>
<div class="line"><span class="lineno"> 2319</span>    <a class="code hl_function" href="monocypher_8c.html#ad2f363aee48f6c6e4b0ea3d14faf6ac2">crypto_eddsa_scalarbase</a>(R, r);</div>
<div class="line"><span class="lineno"> 2320</span>    hash_reduce(h, R, 32, secret_key + 32, 32, message, message_size);</div>
<div class="line"><span class="lineno"> 2321</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(signature, R, 32);</div>
<div class="line"><span class="lineno"> 2322</span>    <a class="code hl_function" href="monocypher_8c.html#a695b55d93cdeaa1b75688389e4aa45c8">crypto_eddsa_mul_add</a>(signature + 32, h, a, r);</div>
<div class="line"><span class="lineno"> 2323</span> </div>
<div class="line"><span class="lineno"> 2324</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(a);</div>
<div class="line"><span class="lineno"> 2325</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(r);</div>
<div class="line"><span class="lineno"> 2326</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a695b55d93cdeaa1b75688389e4aa45c8"><div class="ttname"><a href="monocypher_8c.html#a695b55d93cdeaa1b75688389e4aa45c8">crypto_eddsa_mul_add</a></div><div class="ttdeci">void crypto_eddsa_mul_add(u8 r[32], const u8 a[32], const u8 b[32], const u8 c[32])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01672">monocypher.c:1672</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86969e0548a6ecfdf28ff0efcb2413a2" name="a86969e0548a6ecfdf28ff0efcb2413a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86969e0548a6ecfdf28ff0efcb2413a2">&#9670;&#160;</a></span>crypto_eddsa_to_x25519()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_eddsa_to_x25519 </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>x25519</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>eddsa</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>EdDSA &lt;--&gt; X25519 ///. </p>

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02347">2347</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2348</span>{</div>
<div class="line"><span class="lineno"> 2349</span>    <span class="comment">// (u, v) = ((1+y)/(1-y), sqrt(-486664)*u/x)</span></div>
<div class="line"><span class="lineno"> 2350</span>    <span class="comment">// Only converting y to u, the sign of x is ignored.</span></div>
<div class="line"><span class="lineno"> 2351</span>    <a class="code hl_typedef" href="monocypher_8c.html#a939afbd56e733375ca04aff2e4f852ff">fe</a> t1, t2;</div>
<div class="line"><span class="lineno"> 2352</span>    fe_frombytes(t2, eddsa);</div>
<div class="line"><span class="lineno"> 2353</span>    fe_add(t1, fe_one, t2);</div>
<div class="line"><span class="lineno"> 2354</span>    fe_sub(t2, fe_one, t2);</div>
<div class="line"><span class="lineno"> 2355</span>    fe_invert(t2, t2);</div>
<div class="line"><span class="lineno"> 2356</span>    fe_mul(t1, t1, t2);</div>
<div class="line"><span class="lineno"> 2357</span>    fe_tobytes(x25519, t1);</div>
<div class="line"><span class="lineno"> 2358</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t1);</div>
<div class="line"><span class="lineno"> 2359</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t2);</div>
<div class="line"><span class="lineno"> 2360</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aabc1047df275e017ae5dce43a806b2dc" name="aabc1047df275e017ae5dce43a806b2dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabc1047df275e017ae5dce43a806b2dc">&#9670;&#160;</a></span>crypto_eddsa_trim_scalar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_eddsa_trim_scalar </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>out</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>in</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l01474">1474</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1475</span>{</div>
<div class="line"><span class="lineno"> 1476</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(out, in, 32);</div>
<div class="line"><span class="lineno"> 1477</span>    out[ 0] &amp;= 248;</div>
<div class="line"><span class="lineno"> 1478</span>    out[31] &amp;= 127;</div>
<div class="line"><span class="lineno"> 1479</span>    out[31] |= 64;</div>
<div class="line"><span class="lineno"> 1480</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc46bf25a4fe3640f27541d2511eec97" name="afc46bf25a4fe3640f27541d2511eec97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc46bf25a4fe3640f27541d2511eec97">&#9670;&#160;</a></span>crypto_elligator_key_pair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_elligator_key_pair </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>hidden</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>secret_key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>seed</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02719">2719</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2720</span>{</div>
<div class="line"><span class="lineno"> 2721</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> pk [32]; <span class="comment">// public key</span></div>
<div class="line"><span class="lineno"> 2722</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> buf[64]; <span class="comment">// seed + representative</span></div>
<div class="line"><span class="lineno"> 2723</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(buf + 32, seed, 32);</div>
<div class="line"><span class="lineno"> 2724</span>    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 2725</span>        <a class="code hl_function" href="monocypher_8c.html#a56808226a52141d0abf422c651a8de62">crypto_chacha20_djb</a>(buf, 0, 64, buf+32, zero, 0);</div>
<div class="line"><span class="lineno"> 2726</span>        <a class="code hl_function" href="monocypher_8c.html#a3d723cc737498990cd6f36db997bcfc9">crypto_x25519_dirty_fast</a>(pk, buf); <span class="comment">// or the &quot;small&quot; version</span></div>
<div class="line"><span class="lineno"> 2727</span>    } <span class="keywordflow">while</span>(<a class="code hl_function" href="monocypher_8c.html#af2db5a2825f6c916d23c77939c6e155e">crypto_elligator_rev</a>(buf+32, pk, buf[32]));</div>
<div class="line"><span class="lineno"> 2728</span>    <span class="comment">// Note that the return value of crypto_elligator_rev() is</span></div>
<div class="line"><span class="lineno"> 2729</span>    <span class="comment">// independent from its tweak parameter.</span></div>
<div class="line"><span class="lineno"> 2730</span>    <span class="comment">// Therefore, buf[32] is not actually reused.  Either we loop one</span></div>
<div class="line"><span class="lineno"> 2731</span>    <span class="comment">// more time and buf[32] is used for the new seed, or we succeeded,</span></div>
<div class="line"><span class="lineno"> 2732</span>    <span class="comment">// and buf[32] becomes the tweak parameter.</span></div>
<div class="line"><span class="lineno"> 2733</span> </div>
<div class="line"><span class="lineno"> 2734</span>    <a class="code hl_function" href="monocypher_8c.html#a84904a8f94da26863cb33a9375c0a63a">crypto_wipe</a>(seed, 32);</div>
<div class="line"><span class="lineno"> 2735</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(hidden    , buf + 32, 32);</div>
<div class="line"><span class="lineno"> 2736</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(secret_key, buf     , 32);</div>
<div class="line"><span class="lineno"> 2737</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(buf);</div>
<div class="line"><span class="lineno"> 2738</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(pk);</div>
<div class="line"><span class="lineno"> 2739</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a3d723cc737498990cd6f36db997bcfc9"><div class="ttname"><a href="monocypher_8c.html#a3d723cc737498990cd6f36db997bcfc9">crypto_x25519_dirty_fast</a></div><div class="ttdeci">void crypto_x25519_dirty_fast(u8 public_key[32], const u8 secret_key[32])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l02531">monocypher.c:2531</a></div></div>
<div class="ttc" id="amonocypher_8c_html_af2db5a2825f6c916d23c77939c6e155e"><div class="ttname"><a href="monocypher_8c.html#af2db5a2825f6c916d23c77939c6e155e">crypto_elligator_rev</a></div><div class="ttdeci">int crypto_elligator_rev(u8 hidden[32], const u8 public_key[32], u8 tweak)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l02688">monocypher.c:2688</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e809923727fdb1e97d3f738aa574f54" name="a8e809923727fdb1e97d3f738aa574f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e809923727fdb1e97d3f738aa574f54">&#9670;&#160;</a></span>crypto_elligator_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_elligator_map </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>curve</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>hidden</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02628">2628</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2629</span>{</div>
<div class="line"><span class="lineno"> 2630</span>    <a class="code hl_typedef" href="monocypher_8c.html#a939afbd56e733375ca04aff2e4f852ff">fe</a> r, u, t1, t2, t3;</div>
<div class="line"><span class="lineno"> 2631</span>    fe_frombytes_mask(r, hidden, 2); <span class="comment">// r is encoded in 254 bits.</span></div>
<div class="line"><span class="lineno"> 2632</span>    fe_sq(r, r);</div>
<div class="line"><span class="lineno"> 2633</span>    fe_add(t1, r, r);</div>
<div class="line"><span class="lineno"> 2634</span>    fe_add(u, t1, fe_one);</div>
<div class="line"><span class="lineno"> 2635</span>    fe_sq (t2, u);</div>
<div class="line"><span class="lineno"> 2636</span>    fe_mul(t3, A2, t1);</div>
<div class="line"><span class="lineno"> 2637</span>    fe_sub(t3, t3, t2);</div>
<div class="line"><span class="lineno"> 2638</span>    fe_mul(t3, t3, A);</div>
<div class="line"><span class="lineno"> 2639</span>    fe_mul(t1, t2, u);</div>
<div class="line"><span class="lineno"> 2640</span>    fe_mul(t1, t3, t1);</div>
<div class="line"><span class="lineno"> 2641</span>    <span class="keywordtype">int</span> is_square = invsqrt(t1, t1);</div>
<div class="line"><span class="lineno"> 2642</span>    fe_mul(u, r, ufactor);</div>
<div class="line"><span class="lineno"> 2643</span>    fe_ccopy(u, fe_one, is_square);</div>
<div class="line"><span class="lineno"> 2644</span>    fe_sq (t1, t1);</div>
<div class="line"><span class="lineno"> 2645</span>    fe_mul(u, u, A);</div>
<div class="line"><span class="lineno"> 2646</span>    fe_mul(u, u, t3);</div>
<div class="line"><span class="lineno"> 2647</span>    fe_mul(u, u, t2);</div>
<div class="line"><span class="lineno"> 2648</span>    fe_mul(u, u, t1);</div>
<div class="line"><span class="lineno"> 2649</span>    fe_neg(u, u);</div>
<div class="line"><span class="lineno"> 2650</span>    fe_tobytes(curve, u);</div>
<div class="line"><span class="lineno"> 2651</span> </div>
<div class="line"><span class="lineno"> 2652</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t1);  <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(r);</div>
<div class="line"><span class="lineno"> 2653</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t2);  <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(u);</div>
<div class="line"><span class="lineno"> 2654</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t3);</div>
<div class="line"><span class="lineno"> 2655</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa38de4751de3c8bbba7e5fd015093ff1" name="aa38de4751de3c8bbba7e5fd015093ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa38de4751de3c8bbba7e5fd015093ff1">&#9670;&#160;</a></span>crypto_elligator_rev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto_elligator_rev </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>hidden</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>curve</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>tweak</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02688">2688</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2689</span>{</div>
<div class="line"><span class="lineno"> 2690</span>    <a class="code hl_typedef" href="monocypher_8c.html#a939afbd56e733375ca04aff2e4f852ff">fe</a> t1, t2, t3;</div>
<div class="line"><span class="lineno"> 2691</span>    fe_frombytes(t1, public_key);    <span class="comment">// t1 = u</span></div>
<div class="line"><span class="lineno"> 2692</span> </div>
<div class="line"><span class="lineno"> 2693</span>    fe_add(t2, t1, A);               <span class="comment">// t2 = u + A</span></div>
<div class="line"><span class="lineno"> 2694</span>    fe_mul(t3, t1, t2);</div>
<div class="line"><span class="lineno"> 2695</span>    fe_mul_small(t3, t3, -2);</div>
<div class="line"><span class="lineno"> 2696</span>    <span class="keywordtype">int</span> is_square = invsqrt(t3, t3); <span class="comment">// t3 = sqrt(-1 / non_square * u * (u+A))</span></div>
<div class="line"><span class="lineno"> 2697</span>    <span class="keywordflow">if</span> (is_square) {</div>
<div class="line"><span class="lineno"> 2698</span>        <span class="comment">// The only variable time bit.  This ultimately reveals how many</span></div>
<div class="line"><span class="lineno"> 2699</span>        <span class="comment">// tries it took us to find a representable key.</span></div>
<div class="line"><span class="lineno"> 2700</span>        <span class="comment">// This does not affect security as long as we try keys at random.</span></div>
<div class="line"><span class="lineno"> 2701</span> </div>
<div class="line"><span class="lineno"> 2702</span>        fe_ccopy    (t1, t2, tweak &amp; 1); <span class="comment">// multiply by u if v is positive,</span></div>
<div class="line"><span class="lineno"> 2703</span>        fe_mul      (t3, t1, t3);        <span class="comment">// multiply by u+A otherwise</span></div>
<div class="line"><span class="lineno"> 2704</span>        fe_mul_small(t1, t3, 2);</div>
<div class="line"><span class="lineno"> 2705</span>        fe_neg      (t2, t3);</div>
<div class="line"><span class="lineno"> 2706</span>        fe_ccopy    (t3, t2, fe_isodd(t1));</div>
<div class="line"><span class="lineno"> 2707</span>        fe_tobytes(hidden, t3);</div>
<div class="line"><span class="lineno"> 2708</span> </div>
<div class="line"><span class="lineno"> 2709</span>        <span class="comment">// Pad with two random bits</span></div>
<div class="line"><span class="lineno"> 2710</span>        hidden[31] |= tweak &amp; 0xc0;</div>
<div class="line"><span class="lineno"> 2711</span>    }</div>
<div class="line"><span class="lineno"> 2712</span> </div>
<div class="line"><span class="lineno"> 2713</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t1);</div>
<div class="line"><span class="lineno"> 2714</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t2);</div>
<div class="line"><span class="lineno"> 2715</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t3);</div>
<div class="line"><span class="lineno"> 2716</span>    <span class="keywordflow">return</span> is_square - 1;</div>
<div class="line"><span class="lineno"> 2717</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adfece78aacd1fd68115a5e9c516d561b" name="adfece78aacd1fd68115a5e9c516d561b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfece78aacd1fd68115a5e9c516d561b">&#9670;&#160;</a></span>crypto_poly1305()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_poly1305 </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mac</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00453">453</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  455</span>{</div>
<div class="line"><span class="lineno">  456</span>    <a class="code hl_struct" href="structcrypto__poly1305__ctx.html">crypto_poly1305_ctx</a> ctx;</div>
<div class="line"><span class="lineno">  457</span>    <a class="code hl_function" href="monocypher_8c.html#ac77e5874b8d8a807cfd51d1c65700b75">crypto_poly1305_init</a>  (&amp;ctx, key);</div>
<div class="line"><span class="lineno">  458</span>    <a class="code hl_function" href="monocypher_8c.html#add8d1b0ddda7526387dcca0ef0d6a712">crypto_poly1305_update</a>(&amp;ctx, message, message_size);</div>
<div class="line"><span class="lineno">  459</span>    <a class="code hl_function" href="monocypher_8c.html#a0b8a2c612432d7d5dc41280f4c92a01e">crypto_poly1305_final</a> (&amp;ctx, mac);</div>
<div class="line"><span class="lineno">  460</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a0b8a2c612432d7d5dc41280f4c92a01e"><div class="ttname"><a href="monocypher_8c.html#a0b8a2c612432d7d5dc41280f4c92a01e">crypto_poly1305_final</a></div><div class="ttdeci">void crypto_poly1305_final(crypto_poly1305_ctx *ctx, u8 mac[16])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00424">monocypher.c:424</a></div></div>
<div class="ttc" id="amonocypher_8c_html_ac77e5874b8d8a807cfd51d1c65700b75"><div class="ttname"><a href="monocypher_8c.html#ac77e5874b8d8a807cfd51d1c65700b75">crypto_poly1305_init</a></div><div class="ttdeci">void crypto_poly1305_init(crypto_poly1305_ctx *ctx, const u8 key[32])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00380">monocypher.c:380</a></div></div>
<div class="ttc" id="amonocypher_8c_html_add8d1b0ddda7526387dcca0ef0d6a712"><div class="ttname"><a href="monocypher_8c.html#add8d1b0ddda7526387dcca0ef0d6a712">crypto_poly1305_update</a></div><div class="ttdeci">void crypto_poly1305_update(crypto_poly1305_ctx *ctx, const u8 *message, size_t message_size)</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l00391">monocypher.c:391</a></div></div>
<div class="ttc" id="astructcrypto__poly1305__ctx_html"><div class="ttname"><a href="structcrypto__poly1305__ctx.html">crypto_poly1305_ctx</a></div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00289">monocypher.h:289</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2db62a502fd2224f633778369e56a893" name="a2db62a502fd2224f633778369e56a893"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2db62a502fd2224f633778369e56a893">&#9670;&#160;</a></span>crypto_poly1305_final()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_poly1305_final </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__poly1305__ctx.html">crypto_poly1305_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mac</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00424">424</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  425</span>{</div>
<div class="line"><span class="lineno">  426</span>    <span class="comment">// Process the last block (if any)</span></div>
<div class="line"><span class="lineno">  427</span>    <span class="comment">// We move the final 1 according to remaining input length</span></div>
<div class="line"><span class="lineno">  428</span>    <span class="comment">// (this will add less than 2^130 to the last input block)</span></div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a> != 0) {</div>
<div class="line"><span class="lineno">  430</span>        <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#ace2a45b775196ada7c09894314e5ea1c">c</a> + ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a>, 16 - ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a>);</div>
<div class="line"><span class="lineno">  431</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#ace2a45b775196ada7c09894314e5ea1c">c</a>[ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a>] = 1;</div>
<div class="line"><span class="lineno">  432</span>        poly_block(ctx, ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#ace2a45b775196ada7c09894314e5ea1c">c</a>, 0);</div>
<div class="line"><span class="lineno">  433</span>    }</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>    <span class="comment">// check if we should subtract 2^130-5 by performing the</span></div>
<div class="line"><span class="lineno">  436</span>    <span class="comment">// corresponding carry propagation.</span></div>
<div class="line"><span class="lineno">  437</span>    <a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a> c = 5;</div>
<div class="line"><span class="lineno">  438</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, 4) {</div>
<div class="line"><span class="lineno">  439</span>        c  += ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#af2b600f41d4ec3e47c420730452f9d9a">h</a>[i];</div>
<div class="line"><span class="lineno">  440</span>        c &gt;&gt;= 32;</div>
<div class="line"><span class="lineno">  441</span>    }</div>
<div class="line"><span class="lineno">  442</span>    c += ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#af2b600f41d4ec3e47c420730452f9d9a">h</a>[4];</div>
<div class="line"><span class="lineno">  443</span>    c  = (c &gt;&gt; 2) * 5; <span class="comment">// shift the carry back to the beginning</span></div>
<div class="line"><span class="lineno">  444</span>    <span class="comment">// c now indicates how many times we should subtract 2^130-5 (0 or 1)</span></div>
<div class="line"><span class="lineno">  445</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, 4) {</div>
<div class="line"><span class="lineno">  446</span>        c += (<a class="code hl_typedef" href="monocypher_8c.html#a3f7e2bcbb0b4c338f3c4f6c937cd4234">u64</a>)ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#af2b600f41d4ec3e47c420730452f9d9a">h</a>[i] + ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#afa42a79cd1194dbc6059bcb6b9c27555">pad</a>[i];</div>
<div class="line"><span class="lineno">  447</span>        store32_le(mac + i*4, (<a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>)c);</div>
<div class="line"><span class="lineno">  448</span>        c = c &gt;&gt; 32;</div>
<div class="line"><span class="lineno">  449</span>    }</div>
<div class="line"><span class="lineno">  450</span>    <a class="code hl_define" href="monocypher_8c.html#a2ec2a7ea97bf6be30be6f129bf1f8159">WIPE_CTX</a>(ctx);</div>
<div class="line"><span class="lineno">  451</span>}</div>
<div class="ttc" id="astructcrypto__poly1305__ctx_html_a251ce934c6d4af1d402adcf75444f058"><div class="ttname"><a href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">crypto_poly1305_ctx::c_idx</a></div><div class="ttdeci">size_t c_idx</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00293">monocypher.h:293</a></div></div>
<div class="ttc" id="astructcrypto__poly1305__ctx_html_ace2a45b775196ada7c09894314e5ea1c"><div class="ttname"><a href="structcrypto__poly1305__ctx.html#ace2a45b775196ada7c09894314e5ea1c">crypto_poly1305_ctx::c</a></div><div class="ttdeci">uint8_t c[16]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00292">monocypher.h:292</a></div></div>
<div class="ttc" id="astructcrypto__poly1305__ctx_html_af2b600f41d4ec3e47c420730452f9d9a"><div class="ttname"><a href="structcrypto__poly1305__ctx.html#af2b600f41d4ec3e47c420730452f9d9a">crypto_poly1305_ctx::h</a></div><div class="ttdeci">uint32_t h[5]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00296">monocypher.h:296</a></div></div>
<div class="ttc" id="astructcrypto__poly1305__ctx_html_afa42a79cd1194dbc6059bcb6b9c27555"><div class="ttname"><a href="structcrypto__poly1305__ctx.html#afa42a79cd1194dbc6059bcb6b9c27555">crypto_poly1305_ctx::pad</a></div><div class="ttdeci">uint32_t pad[4]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00295">monocypher.h:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab57b18d15a8b049b18d899a51d732d9a" name="ab57b18d15a8b049b18d899a51d732d9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab57b18d15a8b049b18d899a51d732d9a">&#9670;&#160;</a></span>crypto_poly1305_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_poly1305_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__poly1305__ctx.html">crypto_poly1305_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00380">380</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  381</span>{</div>
<div class="line"><span class="lineno">  382</span>    <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#af2b600f41d4ec3e47c420730452f9d9a">h</a>, 5); <span class="comment">// Initial hash is zero</span></div>
<div class="line"><span class="lineno">  383</span>    ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a> = 0;</div>
<div class="line"><span class="lineno">  384</span>    <span class="comment">// load r and pad (r has some of its bits cleared)</span></div>
<div class="line"><span class="lineno">  385</span>    load32_le_buf(ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#ae6ed00d781ab1278164215819a32557b">r</a>  , key   , 4);</div>
<div class="line"><span class="lineno">  386</span>    load32_le_buf(ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#afa42a79cd1194dbc6059bcb6b9c27555">pad</a>, key+16, 4);</div>
<div class="line"><span class="lineno">  387</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, 1) { ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#ae6ed00d781ab1278164215819a32557b">r</a>[i] &amp;= 0x0fffffff; }</div>
<div class="line"><span class="lineno">  388</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 1, 4) { ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#ae6ed00d781ab1278164215819a32557b">r</a>[i] &amp;= 0x0ffffffc; }</div>
<div class="line"><span class="lineno">  389</span>}</div>
<div class="ttc" id="astructcrypto__poly1305__ctx_html_ae6ed00d781ab1278164215819a32557b"><div class="ttname"><a href="structcrypto__poly1305__ctx.html#ae6ed00d781ab1278164215819a32557b">crypto_poly1305_ctx::r</a></div><div class="ttdeci">uint32_t r[4]</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8h_source.html#l00294">monocypher.h:294</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ff664f4e2cb7c8a41f584018c41646a" name="a9ff664f4e2cb7c8a41f584018c41646a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ff664f4e2cb7c8a41f584018c41646a">&#9670;&#160;</a></span>crypto_poly1305_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_poly1305_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__poly1305__ctx.html">crypto_poly1305_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00391">391</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  393</span>{</div>
<div class="line"><span class="lineno">  394</span>    <span class="comment">// Align ourselves with block boundaries</span></div>
<div class="line"><span class="lineno">  395</span>    <span class="keywordtype">size_t</span> aligned = <a class="code hl_define" href="monocypher_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(align(ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a>, 16), message_size);</div>
<div class="line"><span class="lineno">  396</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, aligned) {</div>
<div class="line"><span class="lineno">  397</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#ace2a45b775196ada7c09894314e5ea1c">c</a>[ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a>] = *message;</div>
<div class="line"><span class="lineno">  398</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a>++;</div>
<div class="line"><span class="lineno">  399</span>        message++;</div>
<div class="line"><span class="lineno">  400</span>        message_size--;</div>
<div class="line"><span class="lineno">  401</span>    }</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>    <span class="comment">// If block is complete, process it</span></div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a> == 16) {</div>
<div class="line"><span class="lineno">  405</span>        poly_block(ctx, ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#ace2a45b775196ada7c09894314e5ea1c">c</a>, 1);</div>
<div class="line"><span class="lineno">  406</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a> = 0;</div>
<div class="line"><span class="lineno">  407</span>    }</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    <span class="comment">// Process the message block by block</span></div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordtype">size_t</span> nb_blocks = message_size &gt;&gt; 4;</div>
<div class="line"><span class="lineno">  411</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, nb_blocks) {</div>
<div class="line"><span class="lineno">  412</span>        poly_block(ctx, message, 1);</div>
<div class="line"><span class="lineno">  413</span>        message += 16;</div>
<div class="line"><span class="lineno">  414</span>    }</div>
<div class="line"><span class="lineno">  415</span>    message_size &amp;= 15;</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="comment">// remaining bytes (we never complete a block here)</span></div>
<div class="line"><span class="lineno">  418</span>    <a class="code hl_define" href="monocypher_8c.html#a7193936d00c5176808a87b6142ba10c3">FOR</a> (i, 0, message_size) {</div>
<div class="line"><span class="lineno">  419</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#ace2a45b775196ada7c09894314e5ea1c">c</a>[ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a>] = message[i];</div>
<div class="line"><span class="lineno">  420</span>        ctx-&gt;<a class="code hl_variable" href="structcrypto__poly1305__ctx.html#a251ce934c6d4af1d402adcf75444f058">c_idx</a>++;</div>
<div class="line"><span class="lineno">  421</span>    }</div>
<div class="line"><span class="lineno">  422</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c6a2ddf6e849ea17747b25d1751271d" name="a2c6a2ddf6e849ea17747b25d1751271d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c6a2ddf6e849ea17747b25d1751271d">&#9670;&#160;</a></span>crypto_verify16()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto_verify16 </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>a</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>b</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00159">159</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  159</span>{ <span class="keywordflow">return</span> neq0(x16(a, b)); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a311150eae3c7e72096237d70f3f3083b" name="a311150eae3c7e72096237d70f3f3083b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a311150eae3c7e72096237d70f3f3083b">&#9670;&#160;</a></span>crypto_verify32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto_verify32 </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>a</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>b</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00160">160</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  160</span>{ <span class="keywordflow">return</span> neq0(x32(a, b)); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c52e2447a43a7e7546f466f55161021" name="a8c52e2447a43a7e7546f466f55161021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c52e2447a43a7e7546f466f55161021">&#9670;&#160;</a></span>crypto_verify64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto_verify64 </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>a</em>[64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>b</em>[64]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00161">161</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  161</span>{ <span class="keywordflow">return</span> neq0(x64(a, b)); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a84904a8f94da26863cb33a9375c0a63a" name="a84904a8f94da26863cb33a9375c0a63a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84904a8f94da26863cb33a9375c0a63a">&#9670;&#160;</a></span>crypto_wipe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_wipe </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00163">163</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  164</span>{</div>
<div class="line"><span class="lineno">  165</span>    <span class="keyword">volatile</span> <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> *v_secret = (<a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a>*)secret;</div>
<div class="line"><span class="lineno">  166</span>    <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(v_secret, size);</div>
<div class="line"><span class="lineno">  167</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba01f73b08a9c4ca852193bc107356ab" name="aba01f73b08a9c4ca852193bc107356ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba01f73b08a9c4ca852193bc107356ab">&#9670;&#160;</a></span>crypto_x25519()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_x25519 </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>raw_shared_secret</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>your_secret_key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>their_public_key</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l01551">1551</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1554</span>{</div>
<div class="line"><span class="lineno"> 1555</span>    <span class="comment">// restrict the possible scalar values</span></div>
<div class="line"><span class="lineno"> 1556</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> e[32];</div>
<div class="line"><span class="lineno"> 1557</span>    <a class="code hl_function" href="monocypher_8c.html#ab5b4a924922762e4c39b93b1dc1a0d50">crypto_eddsa_trim_scalar</a>(e, your_secret_key);</div>
<div class="line"><span class="lineno"> 1558</span>    scalarmult(raw_shared_secret, e, their_public_key, 255);</div>
<div class="line"><span class="lineno"> 1559</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(e);</div>
<div class="line"><span class="lineno"> 1560</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acf6ea02e2f70cd4bff6aa318e2466053" name="acf6ea02e2f70cd4bff6aa318e2466053"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf6ea02e2f70cd4bff6aa318e2466053">&#9670;&#160;</a></span>crypto_x25519_dirty_fast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_x25519_dirty_fast </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pk</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sk</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02531">2531</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2532</span>{</div>
<div class="line"><span class="lineno"> 2533</span>    <span class="comment">// Compute clean scalar multiplication</span></div>
<div class="line"><span class="lineno"> 2534</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> scalar[32];</div>
<div class="line"><span class="lineno"> 2535</span>    <a class="code hl_struct" href="structge.html">ge</a> pk;</div>
<div class="line"><span class="lineno"> 2536</span>    <a class="code hl_function" href="monocypher_8c.html#ab5b4a924922762e4c39b93b1dc1a0d50">crypto_eddsa_trim_scalar</a>(scalar, secret_key);</div>
<div class="line"><span class="lineno"> 2537</span>    ge_scalarmult_base(&amp;pk, scalar);</div>
<div class="line"><span class="lineno"> 2538</span> </div>
<div class="line"><span class="lineno"> 2539</span>    <span class="comment">// Compute low order point</span></div>
<div class="line"><span class="lineno"> 2540</span>    <a class="code hl_typedef" href="monocypher_8c.html#a939afbd56e733375ca04aff2e4f852ff">fe</a> t1, t2;</div>
<div class="line"><span class="lineno"> 2541</span>    select_lop(t1, lop_x, sqrtm1, secret_key[0]);</div>
<div class="line"><span class="lineno"> 2542</span>    select_lop(t2, lop_y, fe_one, secret_key[0] + 2);</div>
<div class="line"><span class="lineno"> 2543</span>    <a class="code hl_struct" href="structge__precomp.html">ge_precomp</a> low_order_point;</div>
<div class="line"><span class="lineno"> 2544</span>    fe_add(low_order_point.<a class="code hl_variable" href="structge__precomp.html#aaecc1f57486ed8318e277f3a69cc2067">Yp</a>, t2, t1);</div>
<div class="line"><span class="lineno"> 2545</span>    fe_sub(low_order_point.<a class="code hl_variable" href="structge__precomp.html#a54bfacb2b26f6e7d58d11a3e62255696">Ym</a>, t2, t1);</div>
<div class="line"><span class="lineno"> 2546</span>    fe_mul(low_order_point.<a class="code hl_variable" href="structge__precomp.html#ac515c95cf11b4ad7ee79bfde33cde4d0">T2</a>, t2, t1);</div>
<div class="line"><span class="lineno"> 2547</span>    fe_mul(low_order_point.<a class="code hl_variable" href="structge__precomp.html#ac515c95cf11b4ad7ee79bfde33cde4d0">T2</a>, low_order_point.<a class="code hl_variable" href="structge__precomp.html#ac515c95cf11b4ad7ee79bfde33cde4d0">T2</a>, D2);</div>
<div class="line"><span class="lineno"> 2548</span> </div>
<div class="line"><span class="lineno"> 2549</span>    <span class="comment">// Add low order point to the public key</span></div>
<div class="line"><span class="lineno"> 2550</span>    ge_madd(&amp;pk, &amp;pk, &amp;low_order_point, t1, t2);</div>
<div class="line"><span class="lineno"> 2551</span> </div>
<div class="line"><span class="lineno"> 2552</span>    <span class="comment">// Convert to Montgomery u coordinate (we ignore the sign)</span></div>
<div class="line"><span class="lineno"> 2553</span>    fe_add(t1, pk.<a class="code hl_variable" href="structge.html#a986005853ea592145fdb69067f4f67e1">Z</a>, pk.<a class="code hl_variable" href="structge.html#a565c2c607ecc7760528eb9ad9b1aec24">Y</a>);</div>
<div class="line"><span class="lineno"> 2554</span>    fe_sub(t2, pk.<a class="code hl_variable" href="structge.html#a986005853ea592145fdb69067f4f67e1">Z</a>, pk.<a class="code hl_variable" href="structge.html#a565c2c607ecc7760528eb9ad9b1aec24">Y</a>);</div>
<div class="line"><span class="lineno"> 2555</span>    fe_invert(t2, t2);</div>
<div class="line"><span class="lineno"> 2556</span>    fe_mul(t1, t1, t2);</div>
<div class="line"><span class="lineno"> 2557</span> </div>
<div class="line"><span class="lineno"> 2558</span>    fe_tobytes(public_key, t1);</div>
<div class="line"><span class="lineno"> 2559</span> </div>
<div class="line"><span class="lineno"> 2560</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t1);    <a class="code hl_define" href="monocypher_8c.html#a2ec2a7ea97bf6be30be6f129bf1f8159">WIPE_CTX</a>(&amp;pk);</div>
<div class="line"><span class="lineno"> 2561</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t2);    <a class="code hl_define" href="monocypher_8c.html#a2ec2a7ea97bf6be30be6f129bf1f8159">WIPE_CTX</a>(&amp;low_order_point);</div>
<div class="line"><span class="lineno"> 2562</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(scalar);</div>
<div class="line"><span class="lineno"> 2563</span>}</div>
<div class="ttc" id="astructge__precomp_html"><div class="ttname"><a href="structge__precomp.html">ge_precomp</a></div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01696">monocypher.c:1696</a></div></div>
<div class="ttc" id="astructge__precomp_html_a54bfacb2b26f6e7d58d11a3e62255696"><div class="ttname"><a href="structge__precomp.html#a54bfacb2b26f6e7d58d11a3e62255696">ge_precomp::Ym</a></div><div class="ttdeci">fe Ym</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01696">monocypher.c:1696</a></div></div>
<div class="ttc" id="astructge__precomp_html_aaecc1f57486ed8318e277f3a69cc2067"><div class="ttname"><a href="structge__precomp.html#aaecc1f57486ed8318e277f3a69cc2067">ge_precomp::Yp</a></div><div class="ttdeci">fe Yp</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01696">monocypher.c:1696</a></div></div>
<div class="ttc" id="astructge__precomp_html_ac515c95cf11b4ad7ee79bfde33cde4d0"><div class="ttname"><a href="structge__precomp.html#ac515c95cf11b4ad7ee79bfde33cde4d0">ge_precomp::T2</a></div><div class="ttdeci">fe T2</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01696">monocypher.c:1696</a></div></div>
<div class="ttc" id="astructge_html_a565c2c607ecc7760528eb9ad9b1aec24"><div class="ttname"><a href="structge.html#a565c2c607ecc7760528eb9ad9b1aec24">ge::Y</a></div><div class="ttdeci">fe Y</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01694">monocypher.c:1694</a></div></div>
<div class="ttc" id="astructge_html_a986005853ea592145fdb69067f4f67e1"><div class="ttname"><a href="structge.html#a986005853ea592145fdb69067f4f67e1">ge::Z</a></div><div class="ttdeci">fe Z</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01694">monocypher.c:1694</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55ccb80a6e7439b981dcb3021648a83a" name="a55ccb80a6e7439b981dcb3021648a83a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55ccb80a6e7439b981dcb3021648a83a">&#9670;&#160;</a></span>crypto_x25519_dirty_small()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_x25519_dirty_small </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pk</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sk</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02450">2450</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2451</span>{</div>
<div class="line"><span class="lineno"> 2452</span>    <span class="comment">// Base point of order 8*L</span></div>
<div class="line"><span class="lineno"> 2453</span>    <span class="comment">// Raw scalar multiplication with it does not clear the cofactor,</span></div>
<div class="line"><span class="lineno"> 2454</span>    <span class="comment">// and the resulting public key will reveal 3 bits of the scalar.</span></div>
<div class="line"><span class="lineno"> 2455</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2456</span>    <span class="comment">// The low order component of this base point  has been chosen</span></div>
<div class="line"><span class="lineno"> 2457</span>    <span class="comment">// to yield the same results as crypto_x25519_dirty_fast().</span></div>
<div class="line"><span class="lineno"> 2458</span>    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> dirty_base_point[32] = {</div>
<div class="line"><span class="lineno"> 2459</span>        0xd8, 0x86, 0x1a, 0xa2, 0x78, 0x7a, 0xd9, 0x26,</div>
<div class="line"><span class="lineno"> 2460</span>        0x8b, 0x74, 0x74, 0xb6, 0x82, 0xe3, 0xbe, 0xc3,</div>
<div class="line"><span class="lineno"> 2461</span>        0xce, 0x36, 0x9a, 0x1e, 0x5e, 0x31, 0x47, 0xa2,</div>
<div class="line"><span class="lineno"> 2462</span>        0x6d, 0x37, 0x7c, 0xfd, 0x20, 0xb5, 0xdf, 0x75,</div>
<div class="line"><span class="lineno"> 2463</span>    };</div>
<div class="line"><span class="lineno"> 2464</span>    <span class="comment">// separate the main factor &amp; the cofactor of the scalar</span></div>
<div class="line"><span class="lineno"> 2465</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> scalar[32];</div>
<div class="line"><span class="lineno"> 2466</span>    <a class="code hl_function" href="monocypher_8c.html#ab5b4a924922762e4c39b93b1dc1a0d50">crypto_eddsa_trim_scalar</a>(scalar, secret_key);</div>
<div class="line"><span class="lineno"> 2467</span> </div>
<div class="line"><span class="lineno"> 2468</span>    <span class="comment">// Separate the main factor and the cofactor</span></div>
<div class="line"><span class="lineno"> 2469</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2470</span>    <span class="comment">// The scalar is trimmed, so its cofactor is cleared.  The three</span></div>
<div class="line"><span class="lineno"> 2471</span>    <span class="comment">// least significant bits however still have a main factor.  We must</span></div>
<div class="line"><span class="lineno"> 2472</span>    <span class="comment">// remove it for X25519 compatibility.</span></div>
<div class="line"><span class="lineno"> 2473</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2474</span>    <span class="comment">//   cofactor = lsb * L            (modulo 8*L)</span></div>
<div class="line"><span class="lineno"> 2475</span>    <span class="comment">//   combined = scalar + cofactor  (modulo 8*L)</span></div>
<div class="line"><span class="lineno"> 2476</span>    add_xl(scalar, secret_key[0]);</div>
<div class="line"><span class="lineno"> 2477</span>    scalarmult(public_key, scalar, dirty_base_point, 256);</div>
<div class="line"><span class="lineno"> 2478</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(scalar);</div>
<div class="line"><span class="lineno"> 2479</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aea80388b64675e8de9e0b0ceb757d956" name="aea80388b64675e8de9e0b0ceb757d956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea80388b64675e8de9e0b0ceb757d956">&#9670;&#160;</a></span>crypto_x25519_inverse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_x25519_inverse </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>blind_salt</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>private_key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>curve_point</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02795">2795</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2797</span>{</div>
<div class="line"><span class="lineno"> 2798</span>    <span class="keyword">static</span> <span class="keyword">const</span>  <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> Lm2[32] = { <span class="comment">// L - 2</span></div>
<div class="line"><span class="lineno"> 2799</span>        0xeb, 0xd3, 0xf5, 0x5c, 0x1a, 0x63, 0x12, 0x58,</div>
<div class="line"><span class="lineno"> 2800</span>        0xd6, 0x9c, 0xf7, 0xa2, 0xde, 0xf9, 0xde, 0x14,</div>
<div class="line"><span class="lineno"> 2801</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><span class="lineno"> 2802</span>        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10,</div>
<div class="line"><span class="lineno"> 2803</span>    };</div>
<div class="line"><span class="lineno"> 2804</span>    <span class="comment">// 1 in Montgomery form</span></div>
<div class="line"><span class="lineno"> 2805</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> m_inv [8] = {</div>
<div class="line"><span class="lineno"> 2806</span>        0x8d98951d, 0xd6ec3174, 0x737dcf70, 0xc6ef5bf4,</div>
<div class="line"><span class="lineno"> 2807</span>        0xfffffffe, 0xffffffff, 0xffffffff, 0x0fffffff,</div>
<div class="line"><span class="lineno"> 2808</span>    };</div>
<div class="line"><span class="lineno"> 2809</span> </div>
<div class="line"><span class="lineno"> 2810</span>    <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> scalar[32];</div>
<div class="line"><span class="lineno"> 2811</span>    <a class="code hl_function" href="monocypher_8c.html#ab5b4a924922762e4c39b93b1dc1a0d50">crypto_eddsa_trim_scalar</a>(scalar, private_key);</div>
<div class="line"><span class="lineno"> 2812</span> </div>
<div class="line"><span class="lineno"> 2813</span>    <span class="comment">// Convert the scalar in Montgomery form</span></div>
<div class="line"><span class="lineno"> 2814</span>    <span class="comment">// m_scl = scalar * 2^256 (modulo L)</span></div>
<div class="line"><span class="lineno"> 2815</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> m_scl[8];</div>
<div class="line"><span class="lineno"> 2816</span>    {</div>
<div class="line"><span class="lineno"> 2817</span>        <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> tmp[16];</div>
<div class="line"><span class="lineno"> 2818</span>        <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(tmp, 8);</div>
<div class="line"><span class="lineno"> 2819</span>        load32_le_buf(tmp+8, scalar, 8);</div>
<div class="line"><span class="lineno"> 2820</span>        mod_l(scalar, tmp);</div>
<div class="line"><span class="lineno"> 2821</span>        load32_le_buf(m_scl, scalar, 8);</div>
<div class="line"><span class="lineno"> 2822</span>        <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(tmp); <span class="comment">// Wipe ASAP to save stack space</span></div>
<div class="line"><span class="lineno"> 2823</span>    }</div>
<div class="line"><span class="lineno"> 2824</span> </div>
<div class="line"><span class="lineno"> 2825</span>    <span class="comment">// Compute the inverse</span></div>
<div class="line"><span class="lineno"> 2826</span>    <a class="code hl_typedef" href="monocypher_8c.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> product[16];</div>
<div class="line"><span class="lineno"> 2827</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 252; i &gt;= 0; i--) {</div>
<div class="line"><span class="lineno"> 2828</span>        <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(product, 16);</div>
<div class="line"><span class="lineno"> 2829</span>        multiply(product, m_inv, m_inv);</div>
<div class="line"><span class="lineno"> 2830</span>        redc(m_inv, product);</div>
<div class="line"><span class="lineno"> 2831</span>        <span class="keywordflow">if</span> (scalar_bit(Lm2, i)) {</div>
<div class="line"><span class="lineno"> 2832</span>            <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(product, 16);</div>
<div class="line"><span class="lineno"> 2833</span>            multiply(product, m_inv, m_scl);</div>
<div class="line"><span class="lineno"> 2834</span>            redc(m_inv, product);</div>
<div class="line"><span class="lineno"> 2835</span>        }</div>
<div class="line"><span class="lineno"> 2836</span>    }</div>
<div class="line"><span class="lineno"> 2837</span>    <span class="comment">// Convert the inverse *out* of Montgomery form</span></div>
<div class="line"><span class="lineno"> 2838</span>    <span class="comment">// scalar = m_inv / 2^256 (modulo L)</span></div>
<div class="line"><span class="lineno"> 2839</span>    <a class="code hl_define" href="monocypher_8c.html#aed003a32e5f74ca9773a89fd44088569">COPY</a>(product, m_inv, 8);</div>
<div class="line"><span class="lineno"> 2840</span>    <a class="code hl_define" href="monocypher_8c.html#adc347ca4ca98f82fa1b041a76a01672a">ZERO</a>(product + 8, 8);</div>
<div class="line"><span class="lineno"> 2841</span>    redc(m_inv, product);</div>
<div class="line"><span class="lineno"> 2842</span>    store32_le_buf(scalar, m_inv, 8); <span class="comment">// the *inverse* of the scalar</span></div>
<div class="line"><span class="lineno"> 2843</span> </div>
<div class="line"><span class="lineno"> 2844</span>    <span class="comment">// Clear the cofactor of scalar:</span></div>
<div class="line"><span class="lineno"> 2845</span>    <span class="comment">//   cleared = scalar * (3*L + 1)      (modulo 8*L)</span></div>
<div class="line"><span class="lineno"> 2846</span>    <span class="comment">//   cleared = scalar + scalar * 3 * L (modulo 8*L)</span></div>
<div class="line"><span class="lineno"> 2847</span>    <span class="comment">// Note that (scalar * 3) is reduced modulo 8, so we only need the</span></div>
<div class="line"><span class="lineno"> 2848</span>    <span class="comment">// first byte.</span></div>
<div class="line"><span class="lineno"> 2849</span>    add_xl(scalar, scalar[0] * 3);</div>
<div class="line"><span class="lineno"> 2850</span> </div>
<div class="line"><span class="lineno"> 2851</span>    <span class="comment">// Recall that 8*L &lt; 2^256. However it is also very close to</span></div>
<div class="line"><span class="lineno"> 2852</span>    <span class="comment">// 2^255. If we spanned the ladder over 255 bits, random tests</span></div>
<div class="line"><span class="lineno"> 2853</span>    <span class="comment">// wouldn&#39;t catch the off-by-one error.</span></div>
<div class="line"><span class="lineno"> 2854</span>    scalarmult(blind_salt, scalar, curve_point, 256);</div>
<div class="line"><span class="lineno"> 2855</span> </div>
<div class="line"><span class="lineno"> 2856</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(scalar);   <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(m_scl);</div>
<div class="line"><span class="lineno"> 2857</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(product);  <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(m_inv);</div>
<div class="line"><span class="lineno"> 2858</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f758c23bd513d3961a083f545222c1d" name="a8f758c23bd513d3961a083f545222c1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f758c23bd513d3961a083f545222c1d">&#9670;&#160;</a></span>crypto_x25519_public_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_x25519_public_key </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>public_key</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>secret_key</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l01562">1562</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1564</span>{</div>
<div class="line"><span class="lineno"> 1565</span>    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_typedef" href="monocypher_8c.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> base_point[32] = {9};</div>
<div class="line"><span class="lineno"> 1566</span>    <a class="code hl_function" href="monocypher_8c.html#a297c5caead6b2a62437c81bef875faa6">crypto_x25519</a>(public_key, secret_key, base_point);</div>
<div class="line"><span class="lineno"> 1567</span>}</div>
<div class="ttc" id="amonocypher_8c_html_a297c5caead6b2a62437c81bef875faa6"><div class="ttname"><a href="monocypher_8c.html#a297c5caead6b2a62437c81bef875faa6">crypto_x25519</a></div><div class="ttdeci">void crypto_x25519(u8 raw_shared_secret[32], const u8 your_secret_key[32], const u8 their_public_key[32])</div><div class="ttdef"><b>Definition</b> <a href="monocypher_8c_source.html#l01551">monocypher.c:1551</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c3366e8cdb2ef53bb1a49ea7b56770c" name="a7c3366e8cdb2ef53bb1a49ea7b56770c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c3366e8cdb2ef53bb1a49ea7b56770c">&#9670;&#160;</a></span>crypto_x25519_to_eddsa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_x25519_to_eddsa </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>eddsa</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>x25519</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l02362">2362</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2363</span>{</div>
<div class="line"><span class="lineno"> 2364</span>    <span class="comment">// (x, y) = (sqrt(-486664)*u/v, (u-1)/(u+1))</span></div>
<div class="line"><span class="lineno"> 2365</span>    <span class="comment">// Only converting u to y, x is assumed positive.</span></div>
<div class="line"><span class="lineno"> 2366</span>    <a class="code hl_typedef" href="monocypher_8c.html#a939afbd56e733375ca04aff2e4f852ff">fe</a> t1, t2;</div>
<div class="line"><span class="lineno"> 2367</span>    fe_frombytes(t2, x25519);</div>
<div class="line"><span class="lineno"> 2368</span>    fe_sub(t1, t2, fe_one);</div>
<div class="line"><span class="lineno"> 2369</span>    fe_add(t2, t2, fe_one);</div>
<div class="line"><span class="lineno"> 2370</span>    fe_invert(t2, t2);</div>
<div class="line"><span class="lineno"> 2371</span>    fe_mul(t1, t1, t2);</div>
<div class="line"><span class="lineno"> 2372</span>    fe_tobytes(eddsa, t1);</div>
<div class="line"><span class="lineno"> 2373</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t1);</div>
<div class="line"><span class="lineno"> 2374</span>    <a class="code hl_define" href="monocypher_8c.html#afd8dec8072750d9351368c9261684eb8">WIPE_BUFFER</a>(t2);</div>
<div class="line"><span class="lineno"> 2375</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a28788739438f137fc99bddeb3188efee" name="a28788739438f137fc99bddeb3188efee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28788739438f137fc99bddeb3188efee">&#9670;&#160;</a></span>crypto_argon2_no_extras</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structcrypto__argon2__extras.html">crypto_argon2_extras</a> crypto_argon2_no_extras</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="monocypher_8c_source.html#l00756">756</a> of file <a class="el" href="monocypher_8c_source.html">monocypher.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  756</span>{ 0, 0, 0, 0 };</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_8dd29cea68de92b9e200250b3bbc73cb.html">techstorm</a></li><li class="navelem"><a class="el" href="dir_ce77d4233c48ea156838b94d75726422.html">lib</a></li><li class="navelem"><a class="el" href="dir_f8e403be0c11a09896ed8277836f57ec.html">rres-1.2.0</a></li><li class="navelem"><a class="el" href="dir_63f1d5203cf255d86d2500401ae86146.html">rres-1.2.0</a></li><li class="navelem"><a class="el" href="dir_1e0b10cabc7b853a5df61de2196db099.html">src</a></li><li class="navelem"><a class="el" href="dir_a5b7f2e2fbc41a12b179659c838fb016.html">external</a></li><li class="navelem"><a class="el" href="monocypher_8h.html">monocypher.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
